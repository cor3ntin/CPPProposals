<!doctype html><html lang="en">
 <head>
  <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
  <meta content="width=device-width, initial-scale=1,
shrink-to-fit=no" name="viewport">
  <title>DxxxxR0: Support for move-only single-pass iterators.</title>
<style data-fill-with="stylesheet">/******************************************************************************
 *                   Style sheet for the W3C specifications                   *
 *
 * Special classes handled by this style sheet include:
 *
 * Indices
 *   - .toc for the Table of Contents (<ol class="toc">)
 *     + <span class="secno"> for the section numbers
 *   - #toc for the Table of Contents (<nav id="toc">)
 *   - ul.index for Indices (<a href="#ref">term</a><span>, in §N.M</span>)
 *   - table.index for Index Tables (e.g. for properties or elements)
 *
 * Structural Markup
 *   - table.data for general data tables
 *     -> use 'scope' attribute, <colgroup>, <thead>, and <tbody> for best results !
 *     -> use <table class='complex data'> for extra-complex tables
 *     -> use <td class='long'> for paragraph-length cell content
 *     -> use <td class='pre'> when manual line breaks/indentation would help readability
 *   - dl.switch for switch statements
 *   - ol.algorithm for algorithms (helps to visualize nesting)
 *   - .figure and .caption (HTML4) and figure and figcaption (HTML5)
 *     -> .sidefigure for right-floated figures
 *   - ins/del
 *
 * Code
 *   - pre and code
 *
 * Special Sections
 *   - .note       for informative notes             (div, p, span, aside, details)
 *   - .example    for informative examples          (div, p, pre, span)
 *   - .issue      for issues                        (div, p, span)
 *   - .assertion  for assertions                    (div, p, span)
 *   - .advisement for loud normative statements     (div, p, strong)
 *   - .annoying-warning for spec obsoletion notices (div, aside, details)
 *
 * Definition Boxes
 *   - pre.def   for WebIDL definitions
 *   - table.def for tables that define other entities (e.g. CSS properties)
 *   - dl.def    for definition lists that define other entitles (e.g. HTML elements)
 *
 * Numbering
 *   - .secno for section numbers in .toc and headings (<span class='secno'>3.2</span>)
 *   - .marker for source-inserted example/figure/issue numbers (<span class='marker'>Issue 4</span>)
 *   - ::before styled for CSS-generated issue/example/figure numbers:
 *     -> Documents wishing to use this only need to add
 *        figcaption::before,
 *        .caption::before { content: "Figure "  counter(figure) " ";  }
 *        .example::before { content: "Example " counter(example) " "; }
 *        .issue::before   { content: "Issue "   counter(issue) " ";   }
 *
 * Header Stuff (ignore, just don't conflict with these classes)
 *   - .head for the header
 *   - .copyright for the copyright
 *
 * Miscellaneous
 *   - .overlarge for things that should be as wide as possible, even if
 *     that overflows the body text area. This can be used on an item or
 *     on its container, depending on the effect desired.
 *     Note that this styling basically doesn't help at all when printing,
 *     since A4 paper isn't much wider than the max-width here.
 *     It's better to design things to fit into a narrower measure if possible.
 *   - js-added ToC jump links (see fixup.js)
 *
 ******************************************************************************/

/******************************************************************************/
/*                                   Body                                     */
/******************************************************************************/

	body {
		counter-reset: example figure issue;

		/* Layout */
		max-width: 50em;               /* limit line length to 50em for readability   */
		margin: 0 auto;                /* center text within page                     */
		padding: 1.6em 1.5em 2em 50px; /* assume 16px font size for downlevel clients */
		padding: 1.6em 1.5em 2em calc(26px + 1.5em); /* leave space for status flag     */

		/* Typography */
		line-height: 1.5;
		font-family: sans-serif;
		widows: 2;
		orphans: 2;
		word-wrap: break-word;
		overflow-wrap: break-word;
		hyphens: auto;

		/* Colors */
		color: black;
		background: white top left fixed no-repeat;
		background-size: 25px auto;
	}


/******************************************************************************/
/*                         Front Matter & Navigation                          */
/******************************************************************************/

/** Header ********************************************************************/

	div.head { margin-bottom: 1em }
	div.head hr { border-style: solid; }

	div.head h1 {
		font-weight: bold;
		margin: 0 0 .1em;
		font-size: 220%;
	}

	div.head h2 { margin-bottom: 1.5em;}

/** W3C Logo ******************************************************************/

	.head .logo {
		float: right;
		margin: 0.4rem 0 0.2rem .4rem;
	}

	.head img[src*="logos/W3C"] {
		display: block;
		border: solid #1a5e9a;
		border-width: .65rem .7rem .6rem;
		border-radius: .4rem;
		background: #1a5e9a;
		color: white;
		font-weight: bold;
	}

	.head a:hover > img[src*="logos/W3C"],
	.head a:focus > img[src*="logos/W3C"] {
		opacity: .8;
	}

	.head a:active > img[src*="logos/W3C"] {
		background: #c00;
		border-color: #c00;
	}

	/* see also additional rules in Link Styling section */

/** Copyright *****************************************************************/

	p.copyright,
	p.copyright small { font-size: small }

/** Back to Top / ToC Toggle **************************************************/

	@media print {
		#toc-nav {
			display: none;
		}
	}
	@media not print {
		#toc-nav {
			position: fixed;
			z-index: 2;
			bottom: 0; left: 0;
			margin: 0;
			min-width: 1.33em;
			border-top-right-radius: 2rem;
			box-shadow: 0 0 2px;
			font-size: 1.5em;
			color: black;
		}
		#toc-nav > a {
			display: block;
			white-space: nowrap;

			height: 1.33em;
			padding: .1em 0.3em;
			margin: 0;

			background: white;
			box-shadow: 0 0 2px;
			border: none;
			border-top-right-radius: 1.33em;
			background: white;
		}
		#toc-nav > #toc-jump {
			padding-bottom: 2em;
			margin-bottom: -1.9em;
		}

		#toc-nav > a:hover,
		#toc-nav > a:focus {
			background: #f8f8f8;
		}
		#toc-nav > a:not(:hover):not(:focus) {
			color: #707070;
		}

		/* statusbar gets in the way on keyboard focus; remove once browsers fix */
		#toc-nav > a[href="#toc"]:not(:hover):focus:last-child {
			padding-bottom: 1.5rem;
		}

		#toc-nav:not(:hover) > a:not(:focus) > span + span {
			/* Ideally this uses :focus-within on #toc-nav */
			display: none;
		}
		#toc-nav > a > span + span {
			padding-right: 0.2em;
		}

		#toc-toggle-inline {
			vertical-align: 0.05em;
			font-size: 80%;
			color: gray;
			color: hsla(203,20%,40%,.7);
			border-style: none;
			background: transparent;
			position: relative;
		}
		#toc-toggle-inline:hover:not(:active),
		#toc-toggle-inline:focus:not(:active) {
			text-shadow: 1px 1px silver;
			top: -1px;
			left: -1px;
		}

		#toc-nav :active {
			color: #C00;
		}
	}

/** ToC Sidebar ***************************************************************/

	/* Floating sidebar */
	@media screen {
		body.toc-sidebar #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			max-width: 80%;
			max-width: calc(100% - 2em - 26px);
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body.toc-sidebar #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}
		body.toc-sidebar #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	/* Hide main scroller when only the ToC is visible anyway */
	@media screen and (max-width: 28em) {
		body.toc-sidebar {
			overflow: hidden;
		}
	}

	/* Sidebar with its own space */
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) #toc {
			position: fixed;
			top: 0; bottom: 0;
			left: 0;
			width: 23.5em;
			overflow: auto;
			padding: 0 1em;
			padding-left: 42px;
			padding-left: calc(1em + 26px);
			background: inherit;
			background-color: #f7f8f9;
			z-index: 1;
			box-shadow: -.1em 0 .25em rgba(0,0,0,.1) inset;
		}
		body:not(.toc-inline) #toc h2 {
			margin-top: .8rem;
			font-variant: small-caps;
			font-variant: all-small-caps;
			text-transform: lowercase;
			font-weight: bold;
			color: gray;
			color: hsla(203,20%,40%,.7);
		}

		body:not(.toc-inline) {
			padding-left: 29em;
		}
		/* See also Overflow section at the bottom */

		body:not(.toc-inline) #toc-jump:not(:focus) {
			width: 0;
			height: 0;
			padding: 0;
			position: absolute;
			overflow: hidden;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) {
			margin: 0 4em;
		}
	}

/******************************************************************************/
/*                                Sectioning                                  */
/******************************************************************************/

/** Headings ******************************************************************/

	h1, h2, h3, h4, h5, h6, dt {
		page-break-after: avoid;
		page-break-inside: avoid;
		font: 100% sans-serif;   /* Reset all font styling to clear out UA styles */
		font-family: inherit;    /* Inherit the font family. */
		line-height: 1.2;        /* Keep wrapped headings compact */
		hyphens: manual;         /* Hyphenated headings look weird */
	}

	h2, h3, h4, h5, h6 {
		margin-top: 3rem;
	}

	h1, h2, h3 {
		color: #005A9C;
		background: transparent;
	}

	h1 { font-size: 170%; }
	h2 { font-size: 140%; }
	h3 { font-size: 120%; }
	h4 { font-weight: bold; }
	h5 { font-style: italic; }
	h6 { font-variant: small-caps; }
	dt { font-weight: bold; }

/** Subheadings ***************************************************************/

	h1 + h2,
	#subtitle {
		/* #subtitle is a subtitle in an H2 under the H1 */
		margin-top: 0;
	}
	h2 + h3,
	h3 + h4,
	h4 + h5,
	h5 + h6 {
		margin-top: 1.2em; /* = 1 x line-height */
	}

/** Section divider ***********************************************************/

	:not(.head) > hr {
		font-size: 1.5em;
		text-align: center;
		margin: 1em auto;
		height: auto;
		border: transparent solid 0;
		background: transparent;
	}
	:not(.head) > hr::before {
		content: "\2727\2003\2003\2727\2003\2003\2727";
	}

/******************************************************************************/
/*                            Paragraphs and Lists                            */
/******************************************************************************/

	p {
		margin: 1em 0;
	}

	dd > p:first-child,
	li > p:first-child {
		margin-top: 0;
	}

	ul, ol {
		margin-left: 0;
		padding-left: 2em;
	}

	li {
		margin: 0.25em 0 0.5em;
		padding: 0;
	}

	dl dd {
		margin: 0 0 .5em 2em;
	}

	.head dd + dd { /* compact for header */
		margin-top: -.5em;
	}

	/* Style for algorithms */
	ol.algorithm ol:not(.algorithm),
	.algorithm > ol ol:not(.algorithm) {
	 border-left: 0.5em solid #DEF;
	}

	/* Put nice boxes around each algorithm. */
	[data-algorithm]:not(.heading) {
	  padding: .5em;
	  border: thin solid #ddd; border-radius: .5em;
	  margin: .5em calc(-0.5em - 1px);
	}
	[data-algorithm]:not(.heading) > :first-child {
	  margin-top: 0;
	}
	[data-algorithm]:not(.heading) > :last-child {
	  margin-bottom: 0;
	}

	/* Style for switch/case <dl>s */
	dl.switch > dd > ol.only,
	dl.switch > dd > .only > ol {
	 margin-left: 0;
	}
	dl.switch > dd > ol.algorithm,
	dl.switch > dd > .algorithm > ol {
	 margin-left: -2em;
	}
	dl.switch {
	 padding-left: 2em;
	}
	dl.switch > dt {
	 text-indent: -1.5em;
	 margin-top: 1em;
	}
	dl.switch > dt + dt {
	 margin-top: 0;
	}
	dl.switch > dt::before {
	 content: '\21AA';
	 padding: 0 0.5em 0 0;
	 display: inline-block;
	 width: 1em;
	 text-align: right;
	 line-height: 0.5em;
	}

/** Terminology Markup ********************************************************/


/******************************************************************************/
/*                                 Inline Markup                              */
/******************************************************************************/

/** Terminology Markup ********************************************************/
	dfn   { /* Defining instance */
		font-weight: bolder;
	}
	a > i { /* Instance of term */
		font-style: normal;
	}
	dt dfn code, code.idl {
		font-size: medium;
	}
	dfn var {
		font-style: normal;
	}

/** Change Marking ************************************************************/

	del { color: red;  text-decoration: line-through; }
	ins { color: #080; text-decoration: underline;    }

/** Miscellaneous improvements to inline formatting ***************************/

	sup {
		vertical-align: super;
		font-size: 80%
	}

/******************************************************************************/
/*                                    Code                                    */
/******************************************************************************/

/** General monospace/pre rules ***********************************************/

	pre, code, samp {
		font-family: Menlo, Consolas, "DejaVu Sans Mono", Monaco, monospace;
		font-size: .9em;
		page-break-inside: avoid;
		hyphens: none;
		text-transform: none;
	}
	pre code,
	code code {
		font-size: 100%;
	}

	pre {
		margin-top: 1em;
		margin-bottom: 1em;
		overflow: auto;
	}

/** Inline Code fragments *****************************************************/

  /* Do something nice. */

/******************************************************************************/
/*                                    Links                                   */
/******************************************************************************/

/** General Hyperlinks ********************************************************/

	/* We hyperlink a lot, so make it less intrusive */
	a[href] {
		color: #034575;
		text-decoration: none;
		border-bottom: 1px solid #707070;
		/* Need a bit of extending for it to look okay */
		padding: 0 1px 0;
		margin: 0 -1px 0;
	}
	a:visited {
		border-bottom-color: #BBB;
	}

	/* Use distinguishing colors when user is interacting with the link */
	a[href]:focus,
	a[href]:hover {
		background: #f8f8f8;
		background: rgba(75%, 75%, 75%, .25);
		border-bottom-width: 3px;
		margin-bottom: -2px;
	}
	a[href]:active {
		color: #C00;
		border-color: #C00;
	}

	/* Backout above styling for W3C logo */
	.head .logo,
	.head .logo a {
		border: none;
		text-decoration: none;
		background: transparent;
	}

/******************************************************************************/
/*                                    Images                                  */
/******************************************************************************/

	img {
		border-style: none;
	}

	/* For autogen numbers, add
	   .caption::before, figcaption::before { content: "Figure " counter(figure) ". "; }
	*/

	figure, .figure, .sidefigure {
		page-break-inside: avoid;
		text-align: center;
		margin: 2.5em 0;
	}
	.figure img,    .sidefigure img,    figure img,
	.figure object, .sidefigure object, figure object {
		max-width: 100%;
		margin: auto;
	}
	.figure pre, .sidefigure pre, figure pre {
		text-align: left;
		display: table;
		margin: 1em auto;
	}
	.figure table, figure table {
		margin: auto;
	}
	@media screen and (min-width: 20em) {
		.sidefigure {
			float: right;
			width: 50%;
			margin: 0 0 0.5em 0.5em
		}
	}
	.caption, figcaption, caption {
		font-style: italic;
		font-size: 90%;
	}
	.caption::before, figcaption::before, figcaption > .marker {
		font-weight: bold;
	}
	.caption, figcaption {
		counter-increment: figure;
	}

	/* DL list is indented 2em, but figure inside it is not */
	dd > .figure, dd > figure { margin-left: -2em }

/******************************************************************************/
/*                             Colored Boxes                                  */
/******************************************************************************/

	.issue, .note, .example, .assertion, .advisement, blockquote {
		padding: .5em;
		border: .5em;
		border-left-style: solid;
		page-break-inside: avoid;
	}
	span.issue, span.note {
		padding: .1em .5em .15em;
		border-right-style: solid;
	}

	.issue,
	.note,
	.example,
	.advisement,
	.assertion,
	blockquote {
		margin: 1em auto;
	}
	.note  > p:first-child,
	.issue > p:first-child,
	blockquote > :first-child {
		margin-top: 0;
	}
	blockquote > :last-child {
		margin-bottom: 0;
	}

/** Blockquotes ***************************************************************/

	blockquote {
		border-color: silver;
	}

/** Open issue ****************************************************************/

	.issue {
		border-color: #E05252;
		background: #FBE9E9;
		counter-increment: issue;
		overflow: auto;
	}
	.issue::before, .issue > .marker {
		text-transform: uppercase;
		color: #AE1E1E;
		padding-right: 1em;
		text-transform: uppercase;
	}
	/* Add .issue::before { content: "Issue " counter(issue) " "; } for autogen numbers,
	   or use class="marker" to mark up the issue number in source. */

/** Example *******************************************************************/

	.example {
		border-color: #E0CB52;
		background: #FCFAEE;
		counter-increment: example;
		overflow: auto;
		clear: both;
	}
	.example::before, .example > .marker {
		text-transform: uppercase;
		color: #827017;
		min-width: 7.5em;
		display: block;
	}
	/* Add .example::before { content: "Example " counter(example) " "; } for autogen numbers,
	   or use class="marker" to mark up the example number in source. */

/** Non-normative Note ********************************************************/

	.note {
		border-color: #52E052;
		background: #E9FBE9;
		overflow: auto;
	}

	.note::before, .note > .marker,
	details.note > summary::before,
	details.note > summary > .marker {
		text-transform: uppercase;
		display: block;
		color: hsl(120, 70%, 30%);
	}
	/* Add .note::before { content: "Note"; } for autogen label,
	   or use class="marker" to mark up the label in source. */

	details.note > summary {
		display: block;
		color: hsl(120, 70%, 30%);
	}
	details.note[open] > summary {
		border-bottom: 1px silver solid;
	}

/** Assertion Box *************************************************************/
	/*  for assertions in algorithms */

	.assertion {
		border-color: #AAA;
		background: #EEE;
	}

/** Advisement Box ************************************************************/
	/*  for attention-grabbing normative statements */

	.advisement {
		border-color: orange;
		border-style: none solid;
		background: #FFEECC;
	}
	strong.advisement {
		display: block;
		text-align: center;
	}
	.advisement > .marker {
		color: #B35F00;
	}

/** Spec Obsoletion Notice ****************************************************/
	/* obnoxious obsoletion notice for older/abandoned specs. */

	details {
		display: block;
	}
	summary {
		font-weight: bolder;
	}

	.annoying-warning:not(details),
	details.annoying-warning:not([open]) > summary,
	details.annoying-warning[open] {
		background: #fdd;
		color: red;
		font-weight: bold;
		padding: .75em 1em;
		border: thick red;
		border-style: solid;
		border-radius: 1em;
	}
	.annoying-warning :last-child {
		margin-bottom: 0;
	}

@media not print {
	details.annoying-warning[open] {
		position: fixed;
		left: 1em;
		right: 1em;
		bottom: 1em;
		z-index: 1000;
	}
}

	details.annoying-warning:not([open]) > summary {
		text-align: center;
	}

/** Entity Definition Boxes ***************************************************/

	.def {
		padding: .5em 1em;
		background: #DEF;
		margin: 1.2em 0;
		border-left: 0.5em solid #8CCBF2;
	}

/******************************************************************************/
/*                                    Tables                                  */
/******************************************************************************/

	th, td {
		text-align: left;
		text-align: start;
	}

/** Property/Descriptor Definition Tables *************************************/

	table.def {
		/* inherits .def box styling, see above */
		width: 100%;
		border-spacing: 0;
	}

	table.def td,
	table.def th {
		padding: 0.5em;
		vertical-align: baseline;
		border-bottom: 1px solid #bbd7e9;
	}

	table.def > tbody > tr:last-child th,
	table.def > tbody > tr:last-child td {
		border-bottom: 0;
	}

	table.def th {
		font-style: italic;
		font-weight: normal;
		padding-left: 1em;
		width: 3em;
	}

	/* For when values are extra-complex and need formatting for readability */
	table td.pre {
		white-space: pre-wrap;
	}

	/* A footnote at the bottom of a def table */
	table.def           td.footnote {
		padding-top: 0.6em;
	}
	table.def           td.footnote::before {
		content: " ";
		display: block;
		height: 0.6em;
		width: 4em;
		border-top: thin solid;
	}

/** Data tables (and properly marked-up index tables) *************************/
	/*
		 <table class="data"> highlights structural relationships in a table
		 when correct markup is used (e.g. thead/tbody, th vs. td, scope attribute)

		 Use class="complex data" for particularly complicated tables --
		 (This will draw more lines: busier, but clearer.)

		 Use class="long" on table cells with paragraph-like contents
		 (This will adjust text alignment accordingly.)
		 Alternately use class="longlastcol" on tables, to have the last column assume "long".
	*/

	table {
		word-wrap: normal;
		overflow-wrap: normal;
		hyphens: manual;
	}

	table.data,
	table.index {
		margin: 1em auto;
		border-collapse: collapse;
		border: hidden;
		width: 100%;
	}
	table.data caption,
	table.index caption {
		max-width: 50em;
		margin: 0 auto 1em;
	}

	table.data td,  table.data th,
	table.index td, table.index th {
		padding: 0.5em 1em;
		border-width: 1px;
		border-color: silver;
		border-top-style: solid;
	}

	table.data thead td:empty {
		padding: 0;
		border: 0;
	}

	table.data  thead,
	table.index thead,
	table.data  tbody,
	table.index tbody {
		border-bottom: 2px solid;
	}

	table.data colgroup,
	table.index colgroup {
		border-left: 2px solid;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		border-right: 2px solid;
		border-top: 1px solid silver;
		padding-right: 1em;
	}

	table.data th[colspan],
	table.data td[colspan] {
		text-align: center;
	}

	table.complex.data th,
	table.complex.data td {
		border: 1px solid silver;
		text-align: center;
	}

	table.data.longlastcol td:last-child,
	table.data td.long {
	 vertical-align: baseline;
	 text-align: left;
	}

	table.data img {
		vertical-align: middle;
	}


/*
Alternate table alignment rules

	table.data,
	table.index {
		text-align: center;
	}

	table.data  thead th[scope="row"],
	table.index thead th[scope="row"] {
		text-align: right;
	}

	table.data  tbody th:first-child,
	table.index tbody th:first-child  {
		text-align: right;
	}

Possible extra rowspan handling

	table.data  tbody th[rowspan]:not([rowspan='1']),
	table.index tbody th[rowspan]:not([rowspan='1']),
	table.data  tbody td[rowspan]:not([rowspan='1']),
	table.index tbody td[rowspan]:not([rowspan='1']) {
		border-left: 1px solid silver;
	}

	table.data  tbody th[rowspan]:first-child,
	table.index tbody th[rowspan]:first-child,
	table.data  tbody td[rowspan]:first-child,
	table.index tbody td[rowspan]:first-child{
		border-left: 0;
		border-right: 1px solid silver;
	}
*/

/******************************************************************************/
/*                                  Indices                                   */
/******************************************************************************/


/** Table of Contents *********************************************************/

	.toc a {
		/* More spacing; use padding to make it part of the click target. */
		padding-top: 0.1rem;
		/* Larger, more consistently-sized click target */
		display: block;
		/* Reverse color scheme */
		color: black;
		border-color: #3980B5;
		border-bottom-width: 3px !important;
		margin-bottom: 0px !important;
	}
	.toc a:visited {
		border-color: #054572;
	}
	.toc a:not(:focus):not(:hover) {
		/* Allow colors to cascade through from link styling */
		border-bottom-color: transparent;
	}

	.toc, .toc ol, .toc ul, .toc li {
		list-style: none; /* Numbers must be inlined into source */
		/* because generated content isn't search/selectable and markers can't do multilevel yet */
		margin:  0;
		padding: 0;
		line-height: 1.1rem; /* consistent spacing */
	}

	/* ToC not indented until third level, but font style & margins show hierarchy */
	.toc > li             { font-weight: bold;   }
	.toc > li li          { font-weight: normal; }
	.toc > li li li       { font-size:   95%;    }
	.toc > li li li li    { font-size:   90%;    }
	.toc > li li li li .secno { font-size: 85%; }
	.toc > li li li li li { font-size:   85%;    }
	.toc > li li li li li .secno { font-size: 100%; }

	/* @supports not (display:grid) { */
		.toc > li             { margin: 1.5rem 0;    }
		.toc > li li          { margin: 0.3rem 0;    }
		.toc > li li li       { margin-left: 2rem;   }

		/* Section numbers in a column of their own */
		.toc .secno {
			float: left;
			width: 4rem;
			white-space: nowrap;
		}

		.toc li {
			clear: both;
		}

		:not(li) > .toc              { margin-left:  5rem; }
		.toc .secno                  { margin-left: -5rem; }
		.toc > li li li .secno       { margin-left: -7rem; }
		.toc > li li li li .secno    { margin-left: -9rem; }
		.toc > li li li li li .secno { margin-left: -11rem; }

		/* Tighten up indentation in narrow ToCs */
		@media (max-width: 30em) {
			:not(li) > .toc              { margin-left:  4rem; }
			.toc .secno                  { margin-left: -4rem; }
			.toc > li li li              { margin-left:  1rem; }
			.toc > li li li .secno       { margin-left: -5rem; }
			.toc > li li li li .secno    { margin-left: -6rem; }
			.toc > li li li li li .secno { margin-left: -7rem; }
		}
	/* } */

	@supports (display:grid) {
		/* Use #toc over .toc to override non-@supports rules. */
		#toc {
			display: grid;
			align-content: start;
			grid-template-columns: auto 1fr;
			grid-column-gap: 1rem;
			column-gap: 1rem;
			grid-row-gap: .6rem;
			row-gap: .6rem;
		}
		#toc h2 {
			grid-column: 1 / -1;
			margin-bottom: 0;
		}
		#toc ol,
		#toc li,
		#toc a {
			display: contents;
			/* Switch <a> to subgrid when supported */
		}
		#toc span {
			margin: 0;
		}
		#toc > .toc > li > a > span {
			/* The spans of the top-level list,
			   comprising the first items of each top-level section. */
			margin-top: 1.1rem;
		}
		#toc#toc .secno { /* Ugh, need more specificity to override base.css */
			grid-column: 1;
			width: auto;
			margin-left: 0;
		}
		#toc .content {
			grid-column: 2;
			width: auto;
			margin-right: 1rem;
		}
		#toc .content:hover {
			background: rgba(75%, 75%, 75%, .25);
			border-bottom: 3px solid #054572;
			margin-bottom: -3px;
		}
		#toc li li li .content {
			margin-left: 1rem;
		}
		#toc li li li li .content {
			margin-left: 2rem;
		}
	}


/** Index *********************************************************************/

	/* Index Lists: Layout */
	ul.index       { margin-left: 0; columns: 15em; text-indent: 1em hanging; }
	ul.index li    { margin-left: 0; list-style: none; break-inside: avoid; }
	ul.index li li { margin-left: 1em }
	ul.index dl    { margin-top: 0; }
	ul.index dt    { margin: .2em 0 .2em 20px;}
	ul.index dd    { margin: .2em 0 .2em 40px;}
	/* Index Lists: Typography */
	ul.index ul,
	ul.index dl { font-size: smaller; }
	@media not print {
		ul.index li span {
			white-space: nowrap;
			color: transparent; }
		ul.index li a:hover + span,
		ul.index li a:focus + span {
			color: #707070;
		}
	}

/** Index Tables *****************************************************/
	/* See also the data table styling section, which this effectively subclasses */

	table.index {
		font-size: small;
		border-collapse: collapse;
		border-spacing: 0;
		text-align: left;
		margin: 1em 0;
	}

	table.index td,
	table.index th {
		padding: 0.4em;
	}

	table.index tr:hover td:not([rowspan]),
	table.index tr:hover th:not([rowspan]) {
		background: #f7f8f9;
	}

	/* The link in the first column in the property table (formerly a TD) */
	table.index th:first-child a {
		font-weight: bold;
	}

/******************************************************************************/
/*                                    Print                                   */
/******************************************************************************/

	@media print {
		/* Pages have their own margins. */
		html {
			margin: 0;
		}
		/* Serif for print. */
		body {
			font-family: serif;
		}
	}
	@page {
		margin: 1.5cm 1.1cm;
	}

/******************************************************************************/
/*                                    Legacy                                  */
/******************************************************************************/

	/* This rule is inherited from past style sheets. No idea what it's for. */
	.hide { display: none }



/******************************************************************************/
/*                             Overflow Control                               */
/******************************************************************************/

	.figure .caption, .sidefigure .caption, figcaption {
		/* in case figure is overlarge, limit caption to 50em */
		max-width: 50rem;
		margin-left: auto;
		margin-right: auto;
	}
	.overlarge > table {
		/* limit preferred width of table */
		max-width: 50em;
		margin-left: auto;
		margin-right: auto;
	}

	@media (min-width: 55em) {
		.overlarge {
			margin-left: calc(13px + 26.5rem - 50vw);
			margin-right: calc(13px + 26.5rem - 50vw);
			max-width: none;
		}
	}
	@media screen and (min-width: 78em) {
		body:not(.toc-inline) .overlarge {
			/* 30.5em body padding 50em content area */
			margin-left: calc(40em - 50vw) !important;
			margin-right: calc(40em - 50vw) !important;
		}
	}
	@media screen and (min-width: 90em) {
		body:not(.toc-inline) .overlarge {
			/* 4em html margin 30.5em body padding 50em content area */
			margin-left: 0 !important;
			margin-right: calc(84.5em - 100vw) !important;
		}
	}

	@media not print {
		.overlarge {
			overflow-x: auto;
			/* See Lea Verou's explanation background-attachment:
			 * http://lea.verou.me/2012/04/background-attachment-local/
			 *
			background: top left  / 4em 100% linear-gradient(to right,  #ffffff, rgba(255, 255, 255, 0)) local,
			            top right / 4em 100% linear-gradient(to left, #ffffff, rgba(255, 255, 255, 0)) local,
			            top left  / 1em 100% linear-gradient(to right,  #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            top right / 1em 100% linear-gradient(to left, #c3c3c5, rgba(195, 195, 197, 0)) scroll,
			            white;
			background-repeat: no-repeat;
			*/
		}
	}
</style>
  <meta content="Bikeshed version a04b880cde96bf0ae2d14a0edcf2bcdcb631548b" name="generator">
  <link href="https://isocpp.org/favicon.ico" rel="icon">
  <meta content="719b26a711190025d910d123b1748e3a16830b75" name="document-revision">
<style>
 table {
    border-collapse: collapse;
}
 th, td {
    padding:10px;
    border: 1px solid black;
 }
</style>
<style>/* style-md-lists */

/* This is a weird hack for me not yet following the commonmark spec
   regarding paragraph and lists. */
[data-md] > :first-child {
    margin-top: 0;
}
[data-md] > :last-child {
    margin-bottom: 0;
}</style>
<style>/* style-counters */

body {
    counter-reset: example figure issue;
}
.issue {
    counter-increment: issue;
}
.issue:not(.no-marker)::before {
    content: "Issue " counter(issue);
}

.example {
    counter-increment: example;
}
.example:not(.no-marker)::before {
    content: "Example " counter(example);
}
.invalid.example:not(.no-marker)::before,
.illegal.example:not(.no-marker)::before {
    content: "Invalid Example" counter(example);
}

figcaption {
    counter-increment: figure;
}
figcaption:not(.no-marker)::before {
    content: "Figure " counter(figure) " ";
}</style>
<style>/* style-syntax-highlighting */

.highlight:not(.idl) { background: hsl(24, 20%, 95%); }
code.highlight { padding: .1em; border-radius: .3em; }
pre.highlight, pre > code.highlight { display: block; padding: 1em; margin: .5em 0; overflow: auto; border-radius: 0; }
c-[a] { color: #990055 } /* Keyword.Declaration */
c-[b] { color: #990055 } /* Keyword.Type */
c-[c] { color: #708090 } /* Comment */
c-[d] { color: #708090 } /* Comment.Multiline */
c-[e] { color: #0077aa } /* Name.Attribute */
c-[f] { color: #669900 } /* Name.Tag */
c-[g] { color: #222222 } /* Name.Variable */
c-[k] { color: #990055 } /* Keyword */
c-[l] { color: #000000 } /* Literal */
c-[m] { color: #000000 } /* Literal.Number */
c-[n] { color: #0077aa } /* Name */
c-[o] { color: #999999 } /* Operator */
c-[p] { color: #999999 } /* Punctuation */
c-[s] { color: #a67f59 } /* Literal.String */
c-[t] { color: #a67f59 } /* Literal.String.Single */
c-[u] { color: #a67f59 } /* Literal.String.Double */
c-[cp] { color: #708090 } /* Comment.Preproc */
c-[c1] { color: #708090 } /* Comment.Single */
c-[cs] { color: #708090 } /* Comment.Special */
c-[kc] { color: #990055 } /* Keyword.Constant */
c-[kn] { color: #990055 } /* Keyword.Namespace */
c-[kp] { color: #990055 } /* Keyword.Pseudo */
c-[kr] { color: #990055 } /* Keyword.Reserved */
c-[ld] { color: #000000 } /* Literal.Date */
c-[nc] { color: #0077aa } /* Name.Class */
c-[no] { color: #0077aa } /* Name.Constant */
c-[nd] { color: #0077aa } /* Name.Decorator */
c-[ni] { color: #0077aa } /* Name.Entity */
c-[ne] { color: #0077aa } /* Name.Exception */
c-[nf] { color: #0077aa } /* Name.Function */
c-[nl] { color: #0077aa } /* Name.Label */
c-[nn] { color: #0077aa } /* Name.Namespace */
c-[py] { color: #0077aa } /* Name.Property */
c-[ow] { color: #999999 } /* Operator.Word */
c-[mb] { color: #000000 } /* Literal.Number.Bin */
c-[mf] { color: #000000 } /* Literal.Number.Float */
c-[mh] { color: #000000 } /* Literal.Number.Hex */
c-[mi] { color: #000000 } /* Literal.Number.Integer */
c-[mo] { color: #000000 } /* Literal.Number.Oct */
c-[sb] { color: #a67f59 } /* Literal.String.Backtick */
c-[sc] { color: #a67f59 } /* Literal.String.Char */
c-[sd] { color: #a67f59 } /* Literal.String.Doc */
c-[se] { color: #a67f59 } /* Literal.String.Escape */
c-[sh] { color: #a67f59 } /* Literal.String.Heredoc */
c-[si] { color: #a67f59 } /* Literal.String.Interpol */
c-[sx] { color: #a67f59 } /* Literal.String.Other */
c-[sr] { color: #a67f59 } /* Literal.String.Regex */
c-[ss] { color: #a67f59 } /* Literal.String.Symbol */
c-[vc] { color: #0077aa } /* Name.Variable.Class */
c-[vg] { color: #0077aa } /* Name.Variable.Global */
c-[vi] { color: #0077aa } /* Name.Variable.Instance */
c-[il] { color: #000000 } /* Literal.Number.Integer.Long */
</style>
<style>/* style-selflinks */

.heading, .issue, .note, .example, li, dt {
    position: relative;
}
a.self-link {
    position: absolute;
    top: 0;
    left: calc(-1 * (3.5rem - 26px));
    width: calc(3.5rem - 26px);
    height: 2em;
    text-align: center;
    border: none;
    transition: opacity .2s;
    opacity: .5;
}
a.self-link:hover {
    opacity: 1;
}
.heading > a.self-link {
    font-size: 83%;
}
li > a.self-link {
    left: calc(-1 * (3.5rem - 26px) - 2em);
}
dfn > a.self-link {
    top: auto;
    left: auto;
    opacity: 0;
    width: 1.5em;
    height: 1.5em;
    background: gray;
    color: white;
    font-style: normal;
    transition: opacity .2s, background-color .2s, color .2s;
}
dfn:hover > a.self-link {
    opacity: 1;
}
dfn > a.self-link:hover {
    color: black;
}

a.self-link::before            { content: "¶"; }
.heading > a.self-link::before { content: "§"; }
dfn > a.self-link::before      { content: "#"; }</style>
<style>/* style-autolinks */

.css.css, .property.property, .descriptor.descriptor {
    color: #005a9c;
    font-size: inherit;
    font-family: inherit;
}
.css::before, .property::before, .descriptor::before {
    content: "‘";
}
.css::after, .property::after, .descriptor::after {
    content: "’";
}
.property, .descriptor {
    /* Don't wrap property and descriptor names */
    white-space: nowrap;
}
.type { /* CSS value <type> */
    font-style: italic;
}
pre .property::before, pre .property::after {
    content: "";
}
[data-link-type="property"]::before,
[data-link-type="propdesc"]::before,
[data-link-type="descriptor"]::before,
[data-link-type="value"]::before,
[data-link-type="function"]::before,
[data-link-type="at-rule"]::before,
[data-link-type="selector"]::before,
[data-link-type="maybe"]::before {
    content: "‘";
}
[data-link-type="property"]::after,
[data-link-type="propdesc"]::after,
[data-link-type="descriptor"]::after,
[data-link-type="value"]::after,
[data-link-type="function"]::after,
[data-link-type="at-rule"]::after,
[data-link-type="selector"]::after,
[data-link-type="maybe"]::after {
    content: "’";
}

[data-link-type].production::before,
[data-link-type].production::after,
.prod [data-link-type]::before,
.prod [data-link-type]::after {
    content: "";
}

[data-link-type=element],
[data-link-type=element-attr] {
    font-family: Menlo, Consolas, "DejaVu Sans Mono", monospace;
    font-size: .9em;
}
[data-link-type=element]::before { content: "<" }
[data-link-type=element]::after  { content: ">" }

[data-link-type=biblio] {
    white-space: pre;
}</style>
 <body class="h-entry">
  <div class="head">
   <p data-fill-with="logo"></p>
   <h1 class="p-name no-ref" id="title">DxxxxR0<br>Support for move-only single-pass iterators.</h1>
   <h2 class="no-num no-toc no-ref heading settled" id="subtitle"><span class="content">Draft Proposal, <time class="dt-updated" datetime="2018-08-20">2018-08-20</time></span></h2>
   <div data-fill-with="spec-metadata">
    <dl>
     <dt>Author:
     <dd>
      <dd class="editor p-author h-card vcard"><a class="p-name fn u-email email" href="mailto:corentin.jabot@gmail.com">Corentin Jabot</a>
     <dt>Audience:
     <dd>LEWG
     <dt>Project:
     <dd>ISO/IEC JTC1/SC22/WG21 14882: Programming Language — C++
    </dl>
   </div>
   <div data-fill-with="warning"></div>
   <hr title="Separator for header">
  </div>
  <div class="p-summary" data-fill-with="abstract">
   <h2 class="no-num no-toc no-ref heading settled" id="abstract"><span class="content">Abstract</span></h2>
   <p>We propose a new iterator taxonomy to allow for move only, single pass iterators</p>
  </div>
  <nav data-fill-with="table-of-contents" id="toc">
   <h2 class="no-num no-toc no-ref" id="contents">Table of Contents</h2>
   <ol class="toc" role="directory">
    <li><a href="#introduction"><span class="secno">1</span> <span class="content">Introduction</span></a>
    <li><a href="#terminology"><span class="secno">2</span> <span class="content">Terminology</span></a>
    <li>
     <a href="#scope"><span class="secno">3</span> <span class="content">Scope</span></a>
     <ol class="toc">
      <li><a href="#non-goal"><span class="secno">3.1</span> <span class="content">Non-Goal</span></a>
     </ol>
    <li>
     <a href="#the-problem"><span class="secno">4</span> <span class="content">The problem</span></a>
     <ol class="toc">
      <li><a href="#some-elements-of-programming"><span class="secno">4.1</span> <span class="content">Some elements of programming</span></a>
      <li><a href="#auto_ptr"><span class="secno">4.2</span> <span class="content">auto_ptr</span></a>
      <li><a href="#implicitly-destructive-operations"><span class="secno">4.3</span> <span class="content">Implicitly destructive operations</span></a>
      <li><a href="#move-only-state"><span class="secno">4.4</span> <span class="content">Move-only state</span></a>
      <li><a href="#performance-optimization"><span class="secno">4.5</span> <span class="content">Performance optimization</span></a>
     </ol>
    <li>
     <a href="#proposed-design"><span class="secno">5</span> <span class="content">Proposed design</span></a>
     <ol class="toc">
      <li><a href="#no-changes-to-the-namespace-std"><span class="secno">5.1</span> <span class="content">No changes to the namespace <code class="highlight"><c- n>std</c-></code></span></a>
      <li><a href="#visual-summary"><span class="secno">5.2</span> <span class="content">Visual summary</span></a>
      <li><a href="#tags"><span class="secno">5.3</span> <span class="content">Tags</span></a>
      <li><a href="#post-increment-on-input-and-output-iterators"><span class="secno">5.4</span> <span class="content">Post Increment on Input and Output Iterators</span></a>
      <li><a href="#common_range"><span class="secno">5.5</span> <span class="content">common_range</span></a>
     </ol>
    <li>
     <a href="#q-a"><span class="secno">6</span> <span class="content">Q/A</span></a>
     <ol class="toc">
      <li><a href="#do-copyable-input-iterator-make-sense"><span class="secno">6.1</span> <span class="content">Do copyable input iterator make sense?</span></a>
      <li><a href="#what-about-copyable-non-comparable-iterators"><span class="secno">6.2</span> <span class="content">What about copyable / non-comparable iterators</span></a>
      <li><a href="#non-regular-iterators-really"><span class="secno">6.3</span> <span class="content">Non-regular iterators, really?</span></a>
      <li><a href="#what-about-p0902r0"><span class="secno">6.4</span> <span class="content">What about <span>[P0902R0]</span> ?</span></a>
     </ol>
    <li>
     <a href="#open-questions-and-bikeshedding"><span class="secno">7</span> <span class="content">Open questions and bikeshedding</span></a>
     <ol class="toc">
      <li><a href="#do-non-regular-views-make-sense"><span class="secno">7.1</span> <span class="content">Do non-regular views make sense?</span></a>
      <li><a href="#does-iterators-default-constructability-needs-revisiting"><span class="secno">7.2</span> <span class="content">Does iterators default-constructability needs revisiting?</span></a>
      <li><a href="#what-about-naming"><span class="secno">7.3</span> <span class="content">What about naming?</span></a>
     </ol>
    <li>
     <a href="#list-of-proposed-changes"><span class="secno">8</span> <span class="content">List of proposed changes</span></a>
     <ol class="toc">
      <li>
       <a href="#changes-to-iterator"><span class="secno">8.1</span> <span class="content">Changes to &lt;iterator></span></a>
       <ol class="toc">
        <li><a href="#weaklyincrementable"><span class="secno">8.1.1</span> <span class="content">WeaklyIncrementable</span></a>
        <li><a href="#inputiterator"><span class="secno">8.1.2</span> <span class="content">InputIterator</span></a>
        <li><a href="#forwarditerator"><span class="secno">8.1.3</span> <span class="content">ForwardIterator</span></a>
        <li><a href="#readableiterator"><span class="secno">8.1.4</span> <span class="content">ReadableIterator</span></a>
        <li><a href="#outputiterator"><span class="secno">8.1.5</span> <span class="content">OutputIterator</span></a>
        <li><a href="#writableiterator"><span class="secno">8.1.6</span> <span class="content">WritableIterator</span></a>
        <li><a href="#mergeable"><span class="secno">8.1.7</span> <span class="content">Mergeable</span></a>
        <li><a href="#other-changes"><span class="secno">8.1.8</span> <span class="content">Other changes</span></a>
       </ol>
      <li>
       <a href="#changes-to-ranges"><span class="secno">8.2</span> <span class="content">Changes to &lt;ranges></span></a>
       <ol class="toc">
        <li><a href="#readablerange"><span class="secno">8.2.1</span> <span class="content">ReadableRange</span></a>
        <li><a href="#writablerange"><span class="secno">8.2.2</span> <span class="content">WritableRange</span></a>
        <li><a href="#views"><span class="secno">8.2.3</span> <span class="content">Views</span></a>
        <li>
         <a href="#inserters"><span class="secno">8.2.4</span> <span class="content">Inserters</span></a>
         <ol class="toc">
          <li><a href="#back_insert_iterator"><span class="secno">8.2.4.1</span> <span class="content">back_insert_iterator</span></a>
          <li><a href="#front_insert_iterator"><span class="secno">8.2.4.2</span> <span class="content">front_insert_iterator</span></a>
          <li><a href="#insert_iterator"><span class="secno">8.2.4.3</span> <span class="content">insert_iterator</span></a>
         </ol>
       </ol>
      <li><a href="#changes-to-algorithms"><span class="secno">8.3</span> <span class="content">Changes to &lt;algorithms></span></a>
     </ol>
    <li>
     <a href="#impact-on-other-proposals"><span class="secno">9</span> <span class="content">Impact on other proposals</span></a>
     <ol class="toc">
      <li><a href="#istream_view"><span class="secno">9.1</span> <span class="content">istream_view</span></a>
      <li><a href="#iterator-facade"><span class="secno">9.2</span> <span class="content">Iterator facade</span></a>
     </ol>
    <li>
     <a href="#references"><span class="secno"></span> <span class="content">References</span></a>
     <ol class="toc">
      <li><a href="#informative"><span class="secno"></span> <span class="content">Informative References</span></a>
     </ol>
   </ol>
  </nav>
  <main>
   <div style="text-align:right"><em>I want to move(it), move(it), y’all want to move(it); </em></div>
   <h2 class="heading settled" data-level="1" id="introduction"><span class="secno">1. </span><span class="content">Introduction</span><a class="self-link" href="#introduction"></a></h2>
   <p>Non-forward Input iterators and output iterators, also known as "Single-pass iterators" are semantically move-only.
The standard states:</p>
   <p class="note" role="note"><span>Note:</span> For input iterators, a == b does not imply ++a == ++b. (Equality does not guarantee the substitution property or referential transparency.) Algorithms on input iterators should never attempt to pass through the same iterator twice. They should be single pass algorithms.</p>
   <p>This means that once an iterator is copied, only one of the copy can meaningfully be used.
Deferencing multiple copies of a single pass iterator often exposes undefined or invalid behavior.</p>
   <p>It would, therefore, make sense that class satisfying the InputIterator concept be move only.
Alas, Single-pass iterators and many classes satisfying its requirements predate C++11, they do therefore have move only semantic with copy syntax.
In that regard, they are similar to <code class="highlight"><c- n>auto_ptr</c-></code>.</p>
   <p>In this paper, we propose a way to introduce the notion of move-only single-pass iterators.</p>
   <h2 class="heading settled" data-level="2" id="terminology"><span class="secno">2. </span><span class="content">Terminology</span><a class="self-link" href="#terminology"></a></h2>
   <p>This paper redefines the requirements of some concepts proposed by the Ranges TS (and the deep merge proposal).
In the rest of this paper</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>InputIterator</c-></code> designs the <code class="highlight"><c- n>InputIterator</c-></code> concept as proposed by this paper</p>
    <li data-md>
     <p><code class="highlight"><c- n>RangesTSInputIterator</c-></code> designs the <code class="highlight"><c- n>InputIterator</c-></code> concept as proposed by the Ranges TS</p>
    <li data-md>
     <p><code class="highlight"><c- n>Cpp17InputIterator</c-></code> design the <strong>requierments</strong> of input iterators compatible with the STL as specified by the C++17 standard</p>
    <li data-md>
     <p><code class="highlight"><c- n>OutputIterator</c-></code> designs the <code class="highlight"><c- n>OutputIterator</c-></code> concept as proposed by this paper</p>
    <li data-md>
     <p><code class="highlight"><c- n>RangesTSOutputIterator</c-></code> designs the <code class="highlight"><c- n>OutputIterator</c-></code> concept as proposed by the Ranges TS</p>
    <li data-md>
     <p><code class="highlight"><c- n>Cpp17OutputIterator</c-></code> design the <strong>requierments</strong> of output iterators compatible with the STL as specified by the C++17 standard</p>
   </ul>
   <h2 class="heading settled" data-level="3" id="scope"><span class="secno">3. </span><span class="content">Scope</span><a class="self-link" href="#scope"></a></h2>
   <p>This paper proposes changes to the Ranges TS and <a data-link-type="biblio" href="#biblio-p0896r2">[P0896R2]</a> both targeting C++20. Because the changes proposed here changes some requirements and concepts as presented
by <a data-link-type="biblio" href="#biblio-p0896r2">[P0896R2]</a>, the authors strongly suggest they are considered for the inclusion in the same version of the standard.
Indeed, <a data-link-type="biblio" href="#biblio-p0896r2">[P0896R2]</a> gives us a unique opportunity to make the change proposed, and it would be a breaking change to introduce the modifications proposed here in a later version of the standard.</p>
   <h3 class="heading settled" data-level="3.1" id="non-goal"><span class="secno">3.1. </span><span class="content">Non-Goal</span><a class="self-link" href="#non-goal"></a></h3>
   <p>As a large amount of code depend on the Input/Output iterators requirements as specified by C++17, this paper does not propose any modifications to the <code class="highlight"><c- n>Cpp17InputIterator</c-></code> or
any class that depends on it.
Specifically, we do not propose to change the requirements or wording of <code class="highlight"><c- n>istream_iterator</c-></code>, <code class="highlight"><c- n>ostream_iterator</c-></code>, <code class="highlight"><c- n>istreambuf_iterator</c-></code> or <code class="highlight"><c- n>ostreambuf_iterator</c-></code>.
Furthermore, we do not propose modifications to algorithms in the namespace <code class="highlight"><c- n>std</c-></code>. The new iterators we propose here are in fact not compatible with existing algorithms.
They are meant to be used in the <code class="highlight"><c- n>ranges</c-></code> namespace and as basic building blocks of range-based views.</p>
   <p>While the ability to use move-only iterators with the algorithms defined in the <code class="highlight"><c- n>std</c-></code> namespace, doing so would weaken the <code class="highlight"><c- n>RangesTSInputIterator</c-></code> concept and leads to other issues
(namely, <code class="highlight"><c- n>std</c-></code> based algorithms require iterators to be EquallyComparable, which the <code class="highlight"><c- n>RangesTSInputIterator</c-></code> is not).</p>
   <p>In practice, that means that entities satisfying the <code class="highlight"><c- n>Cpp17InputIterator</c-></code> will continue to work unaffected with algorithms defined in the <code class="highlight"><c- n>std</c-></code> namespace. They will not be compatible with algorithms defined in the ranges namespace, or with new code using the <code class="highlight"><c- n>InputIterator</c-></code> concept as proposed here.</p>
   <p>Inversely, entities satisfying the <code class="highlight"><c- n>InputIterator</c-></code> concepts will not be compatible with algorithms in <code class="highlight"><c- n>std</c-></code> as they would not be able to satisfy the <code class="highlight"><c- n>Cpp17InputIterator</c-></code> requirements.</p>
   <h2 class="heading settled" data-level="4" id="the-problem"><span class="secno">4. </span><span class="content">The problem</span><a class="self-link" href="#the-problem"></a></h2>
   <h3 class="heading settled" data-level="4.1" id="some-elements-of-programming"><span class="secno">4.1. </span><span class="content">Some elements of programming</span><a class="self-link" href="#some-elements-of-programming"></a></h3>
   <p>Input-devices such as a socket, a serial device, a stream of random numbers, etc are sequential.
They model a stream of data, from which reading is destructive and back-seeking impossible.
Reading from such entity mutate irreversibly the state of that entity.</p>
   <p>Therefore, we could expect that:</p>
<pre class="highlight"><c- k>auto</c-> <c- n>socket_copy</c-> <c- o>=</c-> <c- n>stocket</c-><c- p>;</c->
<c- n>stocket</c-><c- p>.</c-><c- n>read_some</c-><c- p>();</c->
<c- n>assert</c-><c- p>(</c-><c- n>socket</c-> <c- o>!=</c-> <c- n>socket_copy</c-><c- p>);</c->
</pre>
   <p>However, from the point of view of an input device or view, consuming data do not move the position of the reading head.
The state of an input stream is not a property of the entity that produces it.</p>
   <p>This means that serial entities ( devices, views ) are not regular.
Iterators over such entity are therefore non-regular.</p>
<pre class="highlight"><c- k>auto</c-> <c- n>input_iterator_copy</c-> <c- o>=</c-> <c- n>input_iterator</c-><c- p>;</c->
<c- n>assert</c-><c- p>(</c-><c- o>*</c-><c- p>(</c-><c- o>++</c-><c- n>input_iterator_copy</c-><c- p>)</c-> <c- o>==</c-> <c- o>*</c-><c- p>(</c-><c- o>++</c-><c- n>input_iterator</c-><c- p>))</c-> <c- c1>// fails</c->
</pre>
   <p>Because input iterators cannot be copied, they should not be comparable either.
Going back to the reading head metaphor, comparing a reading head to itself make no sense, and
in fact, comparing input or output iterators to anything other than the end-of-stream position never made sense.</p>
   <h3 class="heading settled" data-level="4.2" id="auto_ptr"><span class="secno">4.2. </span><span class="content">auto_ptr</span><a class="self-link" href="#auto_ptr"></a></h3>
   <p>Another way to look at the problem is to say that copyable input iterators fall into the same category of entities than <code class="highlight"><c- n>auto_ptr</c-></code>.
They own a unique, non-copyable "reading head" over a stream or sequence, and their copy operator has ownership transfer semantics.
All the arguments that lead to <code class="highlight"><c- n>auto_ptr</c-></code> depreciation and eventual removal apply equally to input iterators.</p>
   <h3 class="heading settled" data-level="4.3" id="implicitly-destructive-operations"><span class="secno">4.3. </span><span class="content">Implicitly destructive operations</span><a class="self-link" href="#implicitly-destructive-operations"></a></h3>
   <p>More often than not, reading from an input sequence is a destructive operation.
But that destruction is reflected nowhere in the API.
Less experienced developers may not be aware</p>
   <p>By making <code class="highlight"><c- n>InputIterator</c-></code> move only, developers will have to explicitly move them, which both signals the invalidation
of the move-from object, but, more importantly, that the underlying data will be destroyed.</p>
   <h3 class="heading settled" data-level="4.4" id="move-only-state"><span class="secno">4.4. </span><span class="content">Move-only state</span><a class="self-link" href="#move-only-state"></a></h3>
   <p>It may be desirable for an iterate to hold a move-only object, becoming itself move-only, which is not possible with iterators modeling Cpp17Iterator.
A real-world example of such iterator is described in <a data-link-type="biblio" href="#biblio-p0902r0">[P0902R0]</a>.</p>
   <h3 class="heading settled" data-level="4.5" id="performance-optimization"><span class="secno">4.5. </span><span class="content">Performance optimization</span><a class="self-link" href="#performance-optimization"></a></h3>
   <p>Move-only iterators are a performance improvement opportunity
For example, in the presence of <code class="highlight"><c- n>InputIterator</c-></code>s, <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>copy</c-></code> could perform a move rather than a copy of the elements since iteration is destructive.</p>
   <h2 class="heading settled" data-level="5" id="proposed-design"><span class="secno">5. </span><span class="content">Proposed design</span><a class="self-link" href="#proposed-design"></a></h2>
   <p>We propose to make <code class="highlight"><c- n>InputIterator</c-></code> concept match its semantic.
In this design, <code class="highlight"><c- n>InputIterator</c-></code>is required to be <code class="highlight"><c- n>Movable</c-></code> but it is furthermore required <em>not to be</em> Copyable nor <code class="highlight"><c- n>EqualityComparable</c-></code>.</p>
   <p class="note" role="note"><span>Note:</span> An iterator not being <code class="highlight"><c- n>EqualityComparable</c-></code> means that for any given <code class="highlight"><c- n>a</c-></code> and <code class="highlight"><c- n>b</c-></code> instances of that iterator <code class="highlight"><c- n>I</c-></code> there is no operation <code class="highlight"><c- n>a</c-></code> == <code class="highlight"><c- n>b</c-></code>.
However, for such iterator to be useful, there must exist a type <code class="highlight"><c- n>T</c-></code> such that the concept <code class="highlight"><c- n>Sentinel</c-><c- o>&lt;</c-><c- n>I</c-><c- p>,</c-><c- n>T</c-><c- o>></c-></code> is satisfied.
Such a requirement is a property of the algorithm, not of <code class="highlight"><c- n>I</c-></code> itself.
On the other hand, the <code class="highlight"><c- n>ForwardIterator</c-></code> concept of the Ranges TS does require that <code class="highlight"><c- n>Sentinel</c-><c- o>&lt;</c-><c- n>F</c-><c- p>,</c-> <c- n>F</c-><c- o>></c-> <c- n>be</c-> <c- n>satisfied</c-></code>, for any <code class="highlight"><c- n>ForwardIterator</c-></code> <code class="highlight"><c- n>F</c-></code>.</p>
   <p>That allows us to prevent the creation of an Iterator type that would be</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>Copyable</c-></code> and  not <code class="highlight"><c- n>EqualityComparable</c-></code></p>
    <li data-md>
     <p><code class="highlight"><c- n>EqualityComparable</c-></code> but not <code class="highlight"><c- n>Copyable</c-></code>,</p>
   </ul>
   <p>Neither of these things making sense and being a potential source of bugs.</p>
   <p>This leaves us with</p>
   <ul>
    <li data-md>
     <p>InputIterator: Movable, not Copyable, not EquallyComparable</p>
    <li data-md>
     <p>ForwardIterator: Regular</p>
   </ul>
   <p>It is not possible for a given type to meet bot <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>InputIterator</c-></code> requirements since they have
contradictory requirements.</p>
   <p>This leads to the introduction of two new concepts <code class="highlight"><c- n>ReadableIterator</c-></code> and <code class="highlight"><c- n>WritableIterator</c-></code>.
For correctness, these concepts are defined in terms of other iterators:</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>ReadableIterator</c-></code> is defined to be either an <code class="highlight"><c- n>InputIterator</c-></code> or a <code class="highlight"><c- n>ForwardIterator</c-></code>.</p>
    <li data-md>
     <p><code class="highlight"><c- n>WritableIterator</c-></code> is defined to be either an <code class="highlight"><c- n>OutputIterator</c-></code> or a <code class="highlight"><c- n>ForwardIterator</c-></code></p>
   </ul>
   <p>Notice that <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>InputIterator</c-></code> share the <code class="highlight"><c- n>Readable</c-></code> and <code class="highlight"><c- n>Iterator</c-></code> requirements, so indeed,
a ReadableIterator is an Iterator that is Readable.
Symmetrically, a <code class="highlight"><c- n>WritableIterator</c-></code> is an <code class="highlight"><c- n>Iterator</c-></code> that is <code class="highlight"><c- n>Writable</c-></code>.</p>
   <p>However there is no valid ReadableIterator that is neither input or forward, and so <code class="highlight"><c- n>ReadableIterator</c-></code> is defined as</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>ReadableIterator</c-> <c- o>=</c-> <c- n>InputIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>||</c-> <c- n>ForwardIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
</pre>
   <p>and WritableIterator</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>Writable</c-> <c- o>=</c-> <c- n>OutputIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>||</c-> <c- n>ForwardIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
</pre>
   <p>Because this change quite deeply the Iterator concepts taxonomy, we need to adapt algorithms is the <code class="highlight"><c- n>ranges</c-></code> namespace
to use this ReadableIterator concept everywhere a <code class="highlight"><c- n>RangesTSInputIterator</c-></code> is expected.
Notice that there is currently no algorithm that is designed to take non-forward input iterators.
But such algorithms could exist, for example, <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>copy</c-></code> could be specialized for InputIterator and operate a move instead of a copy.</p>
   <h3 class="heading settled" data-level="5.1" id="no-changes-to-the-namespace-std"><span class="secno">5.1. </span><span class="content">No changes to the namespace <code class="highlight"><c- n>std</c-></code></span><a class="self-link" href="#no-changes-to-the-namespace-std"></a></h3>
   <p>An important design constraint was to make sure not to break existing code.
Conservatively that means avoiding modification to existing algorithms in the <code class="highlight"><c- n>std</c-></code> namespace.
Input and Output iterators provided by the standard remain unmodified and most importantly,
the requirements of <code class="highlight"><c- n>Cpp17InputIterator</c-></code> and <code class="highlight"><c- n>Cpp17OutputIterator</c-></code> are left untouched, meaning user-defined iterators meeting the requirements
or either <code class="highlight"><c- n>Cpp17Iterator</c-></code> or <code class="highlight"><c- n>Cpp17OutputIterator</c-></code> will not be impacted by the proposed changes.</p>
   <p>Consequently, the <code class="highlight"><c- n>InputIterator</c-></code> and <code class="highlight"><c- n>OutputIterator</c-></code> specified as described above are not compatible with <code class="highlight"><c- n>Cpp17Iterator</c-></code> requirements.
That means that algorithms in the <code class="highlight"><c- n>std</c-></code> namespace will not work with entities satisfying the <code class="highlight"><c- n>InputIterator</c-></code> or <code class="highlight"><c- n>OutputIterator</c-></code> concepts.</p>
   <p>It also means that algorithms in the <code class="highlight"><c- n>ranges</c-></code> namespace will not accept entities  meeting the <code class="highlight"><c- n>Cpp17InputIterator</c-></code> or <code class="highlight"><c- n>Cpp17OutputIterator</c-></code> requirements.</p>
   <p>In Rapperswil, the following poll was taken</p>
   <blockquote>
    <p>We want the invariant that anything that compiles in std::ranges::foo() &amp; std::foo() has the same semantics/result?</p>
   </blockquote>
   <p>The authors interpreted that poll as an opportunity to do the <em>right thing</em> in the <code class="highlight"><c- n>ranges</c-></code> namespace, at the cost of a less straightforward
migration path between the two.</p>
   <p>New facilities such as <code class="highlight"><c- n>ranges</c-><c- o>::</c-><c- n>istream_view</c-></code> offer cleaner, easier to use, alternatives to the input/output iterators of the stl so a migration
path does exist.</p>
   <table>
    <thead>
     <tr>
      <th title="Field #1">SF
      <th title="Field #2">F
      <th title="Field #3">N
      <th title="Field #4">A
      <th title="Field #5">SA
    <tbody>
     <tr>
      <td>1
      <td>5
      <td>0
      <td>10
      <td>2
   </table>
   <h3 class="heading settled" data-level="5.2" id="visual-summary"><span class="secno">5.2. </span><span class="content">Visual summary</span><a class="self-link" href="#visual-summary"></a></h3>
   <p>The following graph shows a representation of the proposed taxonomy.
Semiregularity requirements are triked from <span style="background-color:#FFBB82">WeaklyIncrementable</span>. <span style="background-color:#6ACFCF">InputIterator</span> and <span style="background-color:#6ACFCF">OutputIterator</span> are modified to require <strong>not to be</strong> EqualityComparable nor Copyable. <span style="background-color:#CCFCCB">ReadableIterator</span> and <span style="background-color:#CCFCCB">WritableIterator</span> are introduced to represent
either an <span style="background-color:#6ACFCF">InputIterator</span> or an <span style="background-color:#6ACFCF">OutputIterator</span> and are meant to
be the primary concept used by algorithms that do not care about the specific iterator capabilities beyond their readability/writability.</p>
   <svg height="676pt" viewBox="0.00 0.00 788.00 676.00" width="788pt" xlink="http://www.w3.org/1999/xlink" xmlns="http://www.w3.org/2000/svg">
    <g class="graph" id="graph1" transform="scale(1 1) rotate(0) translate(4 672)">
     <title>iterator</title>
     <polygon fill="white" points="-4,5 -4,-672 785,-672 785,5 -4,5" stroke="white"></polygon>
     <g class="node" id="node1">
      <title>WeaklyIncrementable</title>
      <polygon fill="#ffbb82" points="551.93,-668 348.07,-668 348.07,-616 551.93,-616 551.93,-668" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="450" y="-636">WeaklyIncrementable</text>
     </g>
     <g class="node" id="node4">
      <title>Iterator</title>
      <polygon fill="none" points="493.135,-580 406.865,-580 406.865,-528 493.135,-528 493.135,-580" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="450" y="-548">Iterator</text>
     </g>
     <g class="edge" id="edge2">
      <title>WeaklyIncrementable->Iterator</title>
      <path d="M450,-615.662C450,-607.702 450,-598.763 450,-590.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="453.5,-590.157 450,-580.157 446.5,-590.157 453.5,-590.157" stroke="black"></polygon>
     </g>
     <g class="node" id="node2">
      <title>Incrementable</title>
      <polygon fill="none" points="172.285,-580 29.7147,-580 29.7147,-528 172.285,-528 172.285,-580" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="101" y="-548">Incrementable</text>
     </g>
     <g class="node" id="node5">
      <title>Cpp17Iterator</title>
      <polygon fill="lightgrey" points="351.138,-492 210.862,-492 210.862,-440 351.138,-440 351.138,-492" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="281" y="-460">Cpp17Iterator</text>
     </g>
     <g class="edge" id="edge4">
      <title>Incrementable->Cpp17Iterator</title>
      <path d="M153.547,-527.894C174.066,-518.091 197.747,-506.777 219.086,-496.581" fill="none" stroke="black"></path>
      <polygon fill="black" points="220.873,-499.606 228.387,-492.137 217.855,-493.29 220.873,-499.606" stroke="black"></polygon>
     </g>
     <g class="node" id="node3">
      <title>EqualityComparable</title>
      <polygon fill="none" points="383.139,-580 190.861,-580 190.861,-528 383.139,-528 383.139,-580" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="287" y="-548">EqualityComparable</text>
     </g>
     <g class="edge" id="edge6">
      <title>EqualityComparable->Cpp17Iterator</title>
      <path d="M285.232,-527.662C284.677,-519.702 284.053,-510.763 283.459,-502.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="286.943,-501.889 282.755,-492.157 279.96,-502.376 286.943,-501.889" stroke="black"></polygon>
     </g>
     <g class="edge" id="edge15">
      <title>Iterator->Cpp17Iterator</title>
      <path d="M406.478,-530.853C386.021,-520.442 361.335,-507.88 339.29,-496.662" fill="none" stroke="black"></path>
      <polygon fill="black" points="340.847,-493.527 330.347,-492.111 337.672,-499.766 340.847,-493.527" stroke="black"></polygon>
     </g>
     <g class="node" id="node12">
      <title>ReadableIterator</title>
      <polygon fill="#ccfccb" points="530.44,-492 369.56,-492 369.56,-440 530.44,-440 530.44,-492" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="450" y="-460">ReadableIterator</text>
     </g>
     <g class="edge" id="edge12">
      <title>Iterator->ReadableIterator</title>
      <path d="M450,-527.662C450,-519.702 450,-510.763 450,-502.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="453.5,-502.157 450,-492.157 446.5,-502.157 453.5,-502.157" stroke="black"></polygon>
     </g>
     <g class="node" id="node13">
      <title>WritableIterator</title>
      <polygon fill="#ccfccb" points="705.109,-492 548.891,-492 548.891,-440 705.109,-440 705.109,-492" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="627" y="-460">WritableIterator</text>
     </g>
     <g class="edge" id="edge22">
      <title>Iterator->WritableIterator</title>
      <path d="M493.299,-531.962C515.261,-521.291 542.299,-508.154 566.301,-496.492" fill="none" stroke="black"></path>
      <polygon fill="black" points="567.869,-499.622 575.334,-492.103 564.81,-493.325 567.869,-499.622" stroke="black"></polygon>
     </g>
     <g class="node" id="node6">
      <title>Cpp17InputIterator</title>
      <polygon fill="lightgrey" points="182.3,-404 -0.30022,-404 -0.30022,-352 182.3,-352 182.3,-404" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="91" y="-372">Cpp17InputIterator</text>
     </g>
     <g class="edge" id="edge16">
      <title>Cpp17Iterator->Cpp17InputIterator</title>
      <path d="M225.533,-439.894C203.68,-430.003 178.43,-418.574 155.749,-408.307" fill="none" stroke="black"></path>
      <polygon fill="black" points="157.089,-405.072 146.536,-404.137 154.203,-411.449 157.089,-405.072" stroke="black"></polygon>
     </g>
     <g class="node" id="node7">
      <title>Cpp17OutputIterator</title>
      <polygon fill="lightgrey" points="395.304,-404 200.696,-404 200.696,-352 395.304,-352 395.304,-404" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="298" y="-372">Cpp17OutputIterator</text>
     </g>
     <g class="edge" id="edge25">
      <title>Cpp17Iterator->Cpp17OutputIterator</title>
      <path d="M286.009,-439.662C287.582,-431.702 289.349,-422.763 291.033,-414.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="294.521,-414.646 293.027,-404.157 287.654,-413.288 294.521,-414.646" stroke="black"></polygon>
     </g>
     <g class="node" id="node8">
      <title>ForwardIterator</title>
      <polygon fill="none" points="500.948,-316 347.052,-316 347.052,-264 500.948,-264 500.948,-316" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="424" y="-284">ForwardIterator</text>
     </g>
     <g class="edge" id="edge17">
      <title>Cpp17InputIterator->ForwardIterator</title>
      <path d="M182.434,-353.386C230.609,-340.945 289.387,-325.765 336.901,-313.494" fill="none" stroke="black"></path>
      <polygon fill="black" points="338.054,-316.811 346.861,-310.922 336.304,-310.034 338.054,-316.811" stroke="black"></polygon>
     </g>
     <g class="node" id="node9">
      <title>BidirectionalIterator</title>
      <polygon fill="none" points="519.449,-228 328.551,-228 328.551,-176 519.449,-176 519.449,-228" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="424" y="-196">BidirectionalIterator</text>
     </g>
     <g class="edge" id="edge18">
      <title>ForwardIterator->BidirectionalIterator</title>
      <path d="M424,-263.662C424,-255.702 424,-246.763 424,-238.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="427.5,-238.157 424,-228.157 420.5,-238.157 427.5,-238.157" stroke="black"></polygon>
     </g>
     <g class="node" id="node10">
      <title>RandomAccessIterator</title>
      <polygon fill="none" points="529.436,-140 318.564,-140 318.564,-88 529.436,-88 529.436,-140" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="424" y="-108">RandomAccessIterator</text>
     </g>
     <g class="edge" id="edge19">
      <title>BidirectionalIterator->RandomAccessIterator</title>
      <path d="M424,-175.662C424,-167.702 424,-158.763 424,-150.245" fill="none" stroke="black"></path>
      <polygon fill="black" points="427.5,-150.157 424,-140.157 420.5,-150.157 427.5,-150.157" stroke="black"></polygon>
     </g>
     <g class="node" id="node11">
      <title>ContiguousIterator</title>
      <polygon fill="none" points="513.308,-52 334.692,-52 334.692,0 513.308,0 513.308,-52" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="424" y="-20">ContiguousIterator</text>
     </g>
     <g class="edge" id="edge20">
      <title>RandomAccessIterator->ContiguousIterator</title>
      <path d="M424,-87.6623C424,-79.7016 424,-70.7633 424,-62.2449" fill="none" stroke="black"></path>
      <polygon fill="black" points="427.5,-62.1566 424,-52.1566 420.5,-62.1566 427.5,-62.1566" stroke="black"></polygon>
     </g>
     <g class="edge" id="edge8">
      <title>ReadableIterator->ForwardIterator</title>
      <path d="M446.219,-439.699C441.759,-409.846 434.314,-360.025 429.284,-326.365" fill="none" stroke="black"></path>
      <polygon fill="black" points="432.683,-325.422 427.743,-316.049 425.759,-326.457 432.683,-325.422" stroke="black"></polygon>
     </g>
     <g class="node" id="node14">
      <title>InputIterator</title>
      <polygon fill="#6acfcf" points="581.296,-404 452.704,-404 452.704,-352 581.296,-352 581.296,-404" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="517" y="-372">InputIterator</text>
     </g>
     <g class="edge" id="edge13">
      <title>ReadableIterator->InputIterator</title>
      <path d="M469.74,-439.662C476.419,-431.089 483.981,-421.382 491.067,-412.287" fill="none" stroke="black"></path>
      <polygon fill="black" points="494.016,-414.196 497.401,-404.157 488.494,-409.894 494.016,-414.196" stroke="black"></polygon>
     </g>
     <g class="edge" id="edge10">
      <title>WritableIterator->ForwardIterator</title>
      <path d="M625.03,-439.746C621.762,-414.445 613.077,-375.917 590,-352 568.835,-330.065 539.12,-315.969 510.671,-306.931" fill="none" stroke="black"></path>
      <polygon fill="black" points="511.669,-303.576 501.085,-304.055 509.658,-310.281 511.669,-303.576" stroke="black"></polygon>
     </g>
     <g class="node" id="node15">
      <title>OutputIterator</title>
      <polygon fill="#6acfcf" points="780.3,-404 637.7,-404 637.7,-352 780.3,-352 780.3,-404" stroke="black"></polygon>
      <text font-family="Times,serif" font-size="20.00" text-anchor="middle" x="709" y="-372">OutputIterator</text>
     </g>
     <g class="edge" id="edge23">
      <title>WritableIterator->OutputIterator</title>
      <path d="M651.159,-439.662C659.584,-430.827 669.157,-420.787 678.056,-411.454" fill="none" stroke="black"></path>
      <polygon fill="black" points="680.646,-413.809 685.013,-404.157 675.58,-408.979 680.646,-413.809" stroke="black"></polygon>
     </g>
    </g>
   </svg>
   <h3 class="heading settled" data-level="5.3" id="tags"><span class="secno">5.3. </span><span class="content">Tags</span><a class="self-link" href="#tags"></a></h3>
   <p>Because <code class="highlight"><c- n>InputIterator</c-></code> as proposed here and <code class="highlight"><c- n>Cpp17InputIterator</c-></code> are irrevocably incompatible, we suggest that <code class="highlight"><c- n>InputIterator</c-></code> should not have
a <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>input_iterator_tag</c-></code> at all. Likewise, <code class="highlight"><c- n>OutputIterator</c-></code> should not have a <code class="highlight"><c- n>std</c-><c- o>::</c-><c- n>output_iterator_tag</c-></code></p>
   <h3 class="heading settled" data-level="5.4" id="post-increment-on-input-and-output-iterators"><span class="secno">5.4. </span><span class="content">Post Increment on Input and Output Iterators</span><a class="self-link" href="#post-increment-on-input-and-output-iterators"></a></h3>
   <p>Post-incrementing move-only iterators would obviously be incorrect. However, a satisfying solution was offered by <a data-link-type="biblio" href="#biblio-p0541r1">[P0541R1]</a>.</p>
   <h3 class="heading settled" data-level="5.5" id="common_range"><span class="secno">5.5. </span><span class="content">common_range</span><a class="self-link" href="#common_range"></a></h3>
   <p><code class="highlight"><c- n>common_range</c-></code> exists so that an <code class="highlight"><c- n>iterator</c-> <c- o>+</c-> <c- n>sentinel</c-></code> pair can be fed to legacy as an <code class="highlight"><c- n>iterator</c-> <c- o>+</c-> <c- n>iterator</c-></code> pair.
While this could let us circumvent the fact that the proposed <code class="highlight"><c- n>InputIterator</c-></code> is not <code class="highlight"><c- n>EquallyComparable</c-></code> ( it already is not in the Ranges TS),
it would not be possible to pass a move only <code class="highlight"><c- n>common_range</c-></code> to a legacy algorithm expecting a semi-regular iterator
( <code class="highlight"><c- n>common_range</c-><c- o>&lt;</c-><c- n>InputIterator</c-><c- p>,</c-> <c- n>S</c-><c- o>></c-></code> would be move-only by virtue of <code class="highlight"><c- n>InputIterator</c-></code> being move-only ).</p>
   <h2 class="heading settled" data-level="6" id="q-a"><span class="secno">6. </span><span class="content">Q/A</span><a class="self-link" href="#q-a"></a></h2>
   <h3 class="heading settled" data-level="6.1" id="do-copyable-input-iterator-make-sense"><span class="secno">6.1. </span><span class="content">Do copyable input iterator make sense?</span><a class="self-link" href="#do-copyable-input-iterator-make-sense"></a></h3>
   <p>If an iterator can be copied, it means you can have multiple reading heads on top of the underlying data, making it a forward iterator.
There is, therefore, no room for a type between move-only InputIterator and ForwardIterator.
However, for compatibility purposes, we propose to keep a <code class="highlight"><c- n>Cpp17InputIterator</c-></code> requirement for existing input iterators.</p>
   <h3 class="heading settled" data-level="6.2" id="what-about-copyable-non-comparable-iterators"><span class="secno">6.2. </span><span class="content">What about copyable / non-comparable iterators</span><a class="self-link" href="#what-about-copyable-non-comparable-iterators"></a></h3>
   <p>An iterator represents a reading head at a given position over some data.
Either the iterator can be copied and position can be compared, or it can not be copied and then comparing positions make no sense.</p>
   <h3 class="heading settled" data-level="6.3" id="non-regular-iterators-really"><span class="secno">6.3. </span><span class="content">Non-regular iterators, really?</span><a class="self-link" href="#non-regular-iterators-really"></a></h3>
   <p>This proposal advocates for Non-Regular Iterators, and weakens <code class="highlight"><c- n>WeaklyIncrementable</c-></code> requirements to that effect.
Non-Regularity is best avoided, so this might feel like going backward.</p>
   <p>However, non-regular types are easier to reason about than types that just pretend to be regular.
Because InputIterator is meant to iterate over a non-regular sequence, it is not regular (whether we like it or not), and the best we can do is
make sure the syntax matches the semantic.</p>
   <h3 class="heading settled" data-level="6.4" id="what-about-p0902r0"><span class="secno">6.4. </span><span class="content">What about <a data-link-type="biblio" href="#biblio-p0902r0">[P0902R0]</a> ?</span><a class="self-link" href="#what-about-p0902r0"></a></h3>
   <p>Andrew Hunter’s "Move-only iterators" paper proposes a design to introduce Move-Only iterators in the taxonomy of <code class="highlight"><c- n>Cpp17Iterator</c-></code>.
However, this design does not offer a solution to use these move-only iterators with existing algorithms, limiting their usefulness.
The iterators proposed by P0902 are additionally <code class="highlight"><c- n>EqualityComparable</c-></code>. The advantage of that is that they are compatible with algorithms
designed with C++17 downward. That’s, however, a potential source of bug and confusion.</p>
   <p>However, if LEWG felt strongly about a solution compatible with existing algorithms it would be possible
to relax the requirements of concerned algorithms to accept move-only iterators. along with the introduction of a new <code class="highlight"><c- n>move_iterator_tag</c-></code> trait.</p>
   <p>Such algorithms would then be compatible with entities satisfying <code class="highlight"><c- n>InputIterator</c-></code> (as proposed by this paper) through a <code class="highlight"><c- n>common_iterator</c-></code> adaptor.</p>
   <p>If proven with enough confidence that requirements of existing algorithms in the <code class="highlight"><c- n>std</c-></code> namespace can be relaxed to handle move-only iterator, the necessary
modifications can be applied in a subsequent standard version (by opposition to this proposal).</p>
   <p>So while there would definitively be value in supporting move-only iterators everywhere it makes sense, and the potential for breakage is relatively low,
we do not propose it for lack of visibility on the consequences of such changes</p>
   <h2 class="heading settled" data-level="7" id="open-questions-and-bikeshedding"><span class="secno">7. </span><span class="content">Open questions and bikeshedding</span><a class="self-link" href="#open-questions-and-bikeshedding"></a></h2>
   <h3 class="heading settled" data-level="7.1" id="do-non-regular-views-make-sense"><span class="secno">7.1. </span><span class="content">Do non-regular views make sense?</span><a class="self-link" href="#do-non-regular-views-make-sense"></a></h3>
   <p>A view that holds a move-only iterator would by definition not be <code class="highlight"><c- n>Semiregular</c-></code>.
Are such views useful?</p>
   <h3 class="heading settled" data-level="7.2" id="does-iterators-default-constructability-needs-revisiting"><span class="secno">7.2. </span><span class="content">Does iterators default-constructability needs revisiting?</span><a class="self-link" href="#does-iterators-default-constructability-needs-revisiting"></a></h3>
   <p>default-constructability of iterator seems to have been added, removed and added back to the Ranges TS and the One Ranges Proposal several
times.
To the best of my knowledge, this was done for the sake of Semiregularity.
Given that this proposal strikes semi-regularity, should this question be revisited?
A valid argument certainly can be either way.</p>
   <h3 class="heading settled" data-level="7.3" id="what-about-naming"><span class="secno">7.3. </span><span class="content">What about naming?</span><a class="self-link" href="#what-about-naming"></a></h3>
   <p>In this proposal, we took the arguably confusing decision to define</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>InputIterator</c-></code> as the proposed single-pass move-only iterator</p>
    <li data-md>
     <p><code class="highlight"><c- n>ReadableIterator</c-></code> as the common superset of <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>InputIterator</c-></code></p>
   </ul>
   <p>Symmetrically,</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>OutputIterator</c-></code> as the proposed single-pass move only writable iterator</p>
    <li data-md>
     <p><code class="highlight"><c- n>WritableIterator</c-></code> as the common superset of (Writable) <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>OutputIterator</c-></code></p>
   </ul>
   <p>This is because:</p>
   <ul>
    <li data-md>
     <p>The semantic of <code class="highlight"><c- n>InputIterator</c-></code> as proposed is no different from the (intended) semantic of <code class="highlight"><c- n>Cpp17InputIterator</c-></code> even if the requirements are rather different and incompatible (ditto for OutputIterator)</p>
    <li data-md>
     <p>Input/Output iterators were aptly named as these terms convey the notion of single-pass.</p>
    <li data-md>
     <p>There exist in the Ranges TS the <code class="highlight"><c- n>Readable</c-></code> and <code class="highlight"><c- n>Writable</c-></code> concepts and <code class="highlight"><c- n>ReadableIterator</c-></code> and <code class="highlight"><c- n>WritableIterator</c-></code> are <code class="highlight"><c- n>Iterator</c-></code> that satisfy these concepts.</p>
   </ul>
   <p>On the other hand, <code class="highlight"><c- n>InputIterator</c-></code> (as proposed) is no longer the root of all other readable iterators,
changing something established 20 years ago, which is certainly a valid concern.</p>
   <p>While the authors of this paper feel strongly that <code class="highlight"><c- n>InputIterator</c-></code> should continue to design the single pass iterator and that <code class="highlight"><c- n>ReadableIterator</c-></code> is a better name
for an iterator whose sole requirement is to be readable, for completeness we suggest this alternative naming scheme:</p>
   <ul>
    <li data-md>
     <p><code class="highlight"><c- n>SinglePassInputIterator</c-></code> as the proposed single-pass move-only iterator</p>
    <li data-md>
     <p><code class="highlight"><c- n>InputIterator</c-></code> as the common superset of <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>SinglePassInputIterator</c-></code> referred to as <code class="highlight"><c- n>ReadableIterator</c-></code> in the rest of this paper</p>
    <li data-md>
     <p><code class="highlight"><c- n>SinglePassOutputIterator</c-></code> as the proposed single-pass move only writable iterator</p>
    <li data-md>
     <p><code class="highlight"><c- n>OutputIterator</c-></code> as the common superset of Writable <code class="highlight"><c- n>ForwardIterator</c-></code> and <code class="highlight"><c- n>SinglePassOutputIterator</c-></code> referred to as <code class="highlight"><c- n>WritableIterator</c-></code> in the rest of this paper</p>
   </ul>
   <p class="note" role="note"><span>Note:</span> in the WD, <code class="highlight"><c- p>[</c-><c- n>Cpp17</c-><c- p>]</c-><c- n>OutputIterator</c-></code> refers to any writable iterator that does not satisfy the requirements of other iterators.</p>
   <h2 class="heading settled" data-level="8" id="list-of-proposed-changes"><span class="secno">8. </span><span class="content">List of proposed changes</span><a class="self-link" href="#list-of-proposed-changes"></a></h2>
   <p>Because the ranges-related proposals are still in flux and will require merging multiple documents, we do not provide wording
at this time.
However, here</p>
   <h3 class="heading settled" data-level="8.1" id="changes-to-iterator"><span class="secno">8.1. </span><span class="content">Changes to &lt;iterator></span><a class="self-link" href="#changes-to-iterator"></a></h3>
   <h4 class="heading settled" data-level="8.1.1" id="weaklyincrementable"><span class="secno">8.1.1. </span><span class="content">WeaklyIncrementable</span><a class="self-link" href="#weaklyincrementable"></a></h4>
   <p><code class="highlight"><c- n>WeaklyIncrementable</c-></code> is a requirement of all <code class="highlight"><c- n>Iterator</c-></code>, including <code class="highlight"><c- n>RangesTSInputIterator</c-></code>. <code class="highlight"><c- n>WeaklyIncrementable</c-></code> is defined to be semi-regular.
Because WeaklyIncrementable, as it is described in <a data-link-type="biblio" href="#biblio-p0896r2">[P0896R2]</a>, accommodates for <code class="highlight"><c- n>RangesTSInputIterator</c-></code> and <code class="highlight"><c- n>Cpp17InputIterator</c-></code>, it suffers from the same issue (being copyable with move semantic).
We propose to strike the <code class="highlight"><c- n>Semiregular</c-></code> requirement as follow</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>WeaklyIncrementable</c-> <c- o>=</c->
    <c- n>Movable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>requires</c-><c- p>(</c-><c- n>I</c-><c- o>&amp;</c-> <c- n>i</c-><c- p>)</c-> <c- p>{</c->
        <c- k>typename</c-> <c- n>iter_difference_t</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
        <c- p>{</c-> <c- o>++</c-><c- n>i</c-> <c- p>}</c-> <c- o>-></c-> <c- n>Same</c-><c- o>&lt;</c-><c- n>I</c-><c- o>&amp;>&amp;&amp;</c-><c- p>;</c->
        <c- n>i</c-><c- o>++</c-><c- p>;</c->
    <c- p>};</c->
</pre>
   <h4 class="heading settled" data-level="8.1.2" id="inputiterator"><span class="secno">8.1.2. </span><span class="content">InputIterator</span><a class="self-link" href="#inputiterator"></a></h4>
   <p>Modify the <code class="highlight"><c- n>InputIterator</c-></code> as follow.
We Specifically disallow Input iterators to be <code class="highlight"><c- n>EqualityComparable</c-></code> or <code class="highlight"><c- n>Copyable</c-></code>.</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>InputIterator</c-> <c- o>=</c->
    <c- n>Readable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>Iterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- o>!</c-> <c- n>Copyable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- o>!</c-> <c- n>EqualityComparable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
</pre>
   <h4 class="heading settled" data-level="8.1.3" id="forwarditerator"><span class="secno">8.1.3. </span><span class="content">ForwardIterator</span><a class="self-link" href="#forwarditerator"></a></h4>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>ForwardIterator</c-> <c- o>=</c->
    <c- n>Iterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>Readable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>EqualityComparable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>Incrementable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>DerivedFrom</c-><c- o>&lt;</c-><c- n>iterator_category_t</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>,</c-> <c- n>forward_iterator_tag</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>Sentinel</c-><c- o>&lt;</c-><c- n>I</c-><c- p>,</c-> <c- n>I</c-><c- o>></c-><c- p>;</c->
</pre>
   <p>ForwardIterator is made <code class="highlight"><c- n>Regular</c-></code> through <code class="highlight"><c- n>Incrementable</c-></code>.
Concepts refining <code class="highlight"><c- n>ForwardIterator</c-></code> are left unchanged</p>
   <h4 class="heading settled" data-level="8.1.4" id="readableiterator"><span class="secno">8.1.4. </span><span class="content">ReadableIterator</span><a class="self-link" href="#readableiterator"></a></h4>
   <p>Introduce a new <code class="highlight"><c- n>ReadableIterator</c-></code> concept, defined as follow</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>ReadableIterator</c-> <c- o>=</c-> <c- n>InputIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>||</c-> <c- n>ForwardIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
</pre>
   <p><code class="highlight"><c- n>ReadableIterator</c-></code> being an <code class="highlight"><c- n>Iterator</c-></code> itself being <code class="highlight"><c- n>ReadableIterator</c-></code> it is <code class="highlight"><c- n>Movable</c-></code>.
All refinement of <code class="highlight"><c- n>ReadableIterator</c-></code> will, therefore, be <code class="highlight"><c- n>Movable</c-></code>, but not necessarily <code class="highlight"><c- n>Copyable</c-></code>.</p>
   <h4 class="heading settled" data-level="8.1.5" id="outputiterator"><span class="secno">8.1.5. </span><span class="content">OutputIterator</span><a class="self-link" href="#outputiterator"></a></h4>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- p>,</c-> <c- k>class</c-> <c- nc>T</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>OutputIterator</c-> <c- o>=</c->
    <c- n>Iterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- n>Writable</c-><c- o>&lt;</c-><c- n>I</c-><c- p>,</c-> <c- n>T</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- o>!</c-> <c- n>Copyable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c->
    <c- o>!</c-> <c- n>EqualityComparable</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-><c- p>;</c->
    <c- n>requires</c-><c- p>(</c-><c- n>I</c-><c- o>&amp;</c-> <c- n>i</c-><c- p>,</c-> <c- n>T</c-><c- o>&amp;&amp;</c-> <c- n>t</c-><c- p>)</c-> <c- p>{</c->
        <c- o>*</c-><c- n>i</c-><c- o>++</c-> <c- o>=</c-> <c- n>std</c-><c- o>::</c-><c- n>forward</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-><c- p>(</c-><c- n>t</c-><c- p>);</c->
    <c- p>};</c->
</pre>
   <h4 class="heading settled" data-level="8.1.6" id="writableiterator"><span class="secno">8.1.6. </span><span class="content">WritableIterator</span><a class="self-link" href="#writableiterator"></a></h4>
   <p>Introduce a new <code class="highlight"><c- n>WritableIterator</c-></code> concept, defined as follow</p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>I</c-><c- p>,</c-> <c- k>class</c-> <c- nc>T</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>WritableIterator</c-> <c- o>=</c-> <c- n>OutputIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- p>,</c-><c- n>T</c-><c- o>></c-> <c- o>||</c-> <c- p>(</c-><c- n>ForwardIterator</c-><c- o>&lt;</c-><c- n>I</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>Writable</c-><c- o>&lt;</c-><c- n>I</c-><c- p>,</c-><c- n>T</c-><c- o>></c-><c- p>);</c->
</pre>
   <h4 class="heading settled" data-level="8.1.7" id="mergeable"><span class="secno">8.1.7. </span><span class="content">Mergeable</span><a class="self-link" href="#mergeable"></a></h4>
   <p>Modify the Meargeable concept to accept a ReadableIterator instead of a <code class="highlight"><c- n>RangesTSInputIterator</c-></code></p>
<pre class="highlight"><c- k>template</c-><c- o>&lt;</c-><c- k>class</c-> <c- nc>I1</c-><c- p>,</c-> <c- k>class</c-> <c- nc>I2</c-><c- p>,</c-> <c- k>class</c-> <c- nc>Out</c-><c- p>,</c->
<c- k>class</c-> <c- nc>R</c-> <c- o>=</c-> <c- n>ranges</c-><c- o>::</c-><c- n>less</c-><c- o>&lt;></c-><c- p>,</c-> <c- k>class</c-> <c- nc>P1</c-> <c- o>=</c-> <c- n>identity</c-><c- p>,</c-> <c- k>class</c-> <c- nc>P2</c-> <c- o>=</c-> <c- n>identity</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>Mergeable</c-> <c- o>=</c->
<c- n>ReadableIterator</c-><c- o>&lt;</c-><c- n>I1</c-><c- o>></c-> <c- o>&amp;&amp;</c->
<c- n>ReadableIterator</c-><c- o>&lt;</c-><c- n>I2</c-><c- o>></c-> <c- o>&amp;&amp;</c->
<c- n>WeaklyIncrementable</c-><c- o>&lt;</c-><c- n>Out</c-><c- o>></c-> <c- o>&amp;&amp;</c->
<c- n>IndirectlyCopyable</c-><c- o>&lt;</c-><c- n>I1</c-><c- p>,</c-> <c- n>Out</c-><c- o>></c-> <c- o>&amp;&amp;</c->
<c- n>IndirectlyCopyable</c-><c- o>&lt;</c-><c- n>I2</c-><c- p>,</c-> <c- n>Out</c-><c- o>></c-> <c- o>&amp;&amp;</c->
<c- n>IndirectStrictWeakOrder</c-><c- o>&lt;</c-><c- n>R</c-><c- p>,</c-> <c- n>projected</c-><c- o>&lt;</c-><c- n>I1</c-><c- p>,</c-> <c- n>P1</c-><c- o>></c-><c- p>,</c-> <c- n>projected</c-><c- o>&lt;</c-><c- n>I2</c-><c- p>,</c-> <c- n>P2</c-><c- o>>></c-><c- p>;</c->
</pre>
   <h4 class="heading settled" data-level="8.1.8" id="other-changes"><span class="secno">8.1.8. </span><span class="content">Other changes</span><a class="self-link" href="#other-changes"></a></h4>
   <ul>
    <li data-md>
     <p>common_iterator should take a ReadableIterator?</p>
    <li data-md>
     <p>iter_move should take a ReadableIterator</p>
    <li data-md>
     <p>iterator_traits should take a ReadableIterator</p>
   </ul>
   <h3 class="heading settled" data-level="8.2" id="changes-to-ranges"><span class="secno">8.2. </span><span class="content">Changes to &lt;ranges></span><a class="self-link" href="#changes-to-ranges"></a></h3>
   <h4 class="heading settled" data-level="8.2.1" id="readablerange"><span class="secno">8.2.1. </span><span class="content">ReadableRange</span><a class="self-link" href="#readablerange"></a></h4>
   <p>Introduce a new concept <code class="highlight"><c- n>ReadableRange</c-></code></p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>T</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>ReadableRange</c-> <c- o>=</c-> <c- n>Range</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>ReadableIterator</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>></c-><c- p>;</c->
</pre>
   <h4 class="heading settled" data-level="8.2.2" id="writablerange"><span class="secno">8.2.2. </span><span class="content">WritableRange</span><a class="self-link" href="#writablerange"></a></h4>
   <p>Introduce a new concept <code class="highlight"><c- n>WritableRange</c-></code></p>
<pre class="highlight"><c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>T</c-><c- o>></c->
<c- n>concept</c-> <c- b>bool</c-> <c- n>WritableRange</c-> <c- o>=</c-> <c- n>Range</c-><c- o>&lt;</c-><c- n>T</c-><c- o>></c-> <c- o>&amp;&amp;</c-> <c- n>WritableIterator</c-><c- o>&lt;</c-><c- n>iterator_t</c-><c- o>&lt;</c-><c- n>T</c-><c- o>>></c-><c- p>;</c->
</pre>
   <h4 class="heading settled" data-level="8.2.3" id="views"><span class="secno">8.2.3. </span><span class="content">Views</span><a class="self-link" href="#views"></a></h4>
   <ul>
    <li data-md>
     <p>The SemiRegular requirement is removed from view over a non-semi-regular ranges</p>
    <li data-md>
     <p>The concerned views are modified to take a <code class="highlight"><c- n>ReadableRange</c-></code> instead of an <code class="highlight"><c- n>InputRange</c-></code></p>
   </ul>
   <h4 class="heading settled" data-level="8.2.4" id="inserters"><span class="secno">8.2.4. </span><span class="content">Inserters</span><a class="self-link" href="#inserters"></a></h4>
   <p>Because the <code class="highlight"><c- n>OutputIterator</c-></code> concept as proposed here is not compatible with the <code class="highlight"><c- n>Cpp17OutputIterator</c-></code> requirements, it would not be possible to
use <code class="highlight"><c- n>std</c-><c- o>::</c-></code> inserters with the <code class="highlight"><c- n>ranges</c-><c- o>::</c-></code> algorithms.</p>
   <p>It is, therefore, necessary to provide suitable inserters modeling <code class="highlight"><c- n>OutputIterator</c-></code></p>
   <h5 class="heading settled" data-level="8.2.4.1" id="back_insert_iterator"><span class="secno">8.2.4.1. </span><span class="content">back_insert_iterator</span><a class="self-link" href="#back_insert_iterator"></a></h5>
<pre class="highlight"><c- k>namespace</c-> <c- n>std</c-><c- o>::</c-><c- n>ranges</c-> <c- p>{</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- k>class</c-> <c- nc>back_insert_iterator</c-> <c- o>:</c-> <c- k>public</c-> <c- n>std</c-><c- o>::</c-><c- n>back_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- p>{</c->
<c- k>public</c-><c- o>:</c->
    <c- k>using</c-> <c- n>std</c-><c- o>::</c-><c- n>back_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>>::</c-><c- n>back_insert_iterator</c-><c- p>;</c->
    <c- n>back_insert_iterator</c-><c- p>(</c-><c- k>const</c-> <c- n>back_insert_iterator</c-> <c- o>&amp;</c-> <c- n>other</c-><c- p>)</c-> <c- o>=</c-> <c- k>delete</c-><c- p>;</c->
    <c- n>back_insert_iterator</c-><c- p>(</c-><c- n>back_insert_iterator</c-> <c- o>&amp;&amp;</c-> <c- n>other</c-><c- p>)</c->

<c- p>};</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- n>back_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- n>back_inserter</c-><c- p>(</c-><c- n>Container</c-><c- o>&amp;</c-> <c- n>x</c-><c- p>);</c->
<c- p>}</c->
</pre>
   <h5 class="heading settled" data-level="8.2.4.2" id="front_insert_iterator"><span class="secno">8.2.4.2. </span><span class="content">front_insert_iterator</span><a class="self-link" href="#front_insert_iterator"></a></h5>
<pre class="highlight"><c- k>namespace</c-> <c- n>std</c-><c- o>::</c-><c- n>ranges</c-> <c- p>{</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- k>class</c-> <c- nc>front_insert_iterator</c-> <c- o>:</c-> <c- k>public</c-> <c- n>std</c-><c- o>::</c-><c- n>front_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- p>{</c->
<c- k>public</c-><c- o>:</c->
    <c- k>using</c-> <c- n>std</c-><c- o>::</c-><c- n>front_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>>::</c-><c- n>front_insert_iterator</c-><c- p>;</c->
    <c- n>front_insert_iterator</c-><c- p>(</c-><c- k>const</c-> <c- n>front_insert_iterator</c-> <c- o>&amp;</c-> <c- n>other</c-><c- p>)</c-> <c- o>=</c-> <c- k>delete</c-><c- p>;</c->
    <c- n>front_insert_iterator</c-><c- p>(</c-><c- n>front_insert_iterator</c-> <c- o>&amp;&amp;</c-> <c- n>other</c-><c- p>);</c->
<c- p>};</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- n>front_insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- n>front_inserter</c-><c- p>(</c-><c- n>Container</c-><c- o>&amp;</c-> <c- n>x</c-><c- p>);</c->
<c- p>}</c->
</pre>
   <h5 class="heading settled" data-level="8.2.4.3" id="insert_iterator"><span class="secno">8.2.4.3. </span><span class="content">insert_iterator</span><a class="self-link" href="#insert_iterator"></a></h5>
<pre class="highlight"><c- k>namespace</c-> <c- n>std</c-><c- o>::</c-><c- n>ranges</c-> <c- p>{</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- k>class</c-> <c- nc>insert_iterator</c-> <c- o>:</c-> <c- k>public</c-> <c- n>std</c-><c- o>::</c-><c- n>insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- p>{</c->
<c- k>public</c-><c- o>:</c->
    <c- k>using</c-> <c- n>std</c-><c- o>::</c-><c- n>insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>>::</c-><c- n>insert_iterator</c-><c- p>;</c->
    <c- n>insert_iterator</c-><c- p>(</c-><c- k>const</c-> <c- n>insert_iterator</c-> <c- o>&amp;</c-> <c- n>other</c-><c- p>)</c-> <c- o>=</c-> <c- k>delete</c-><c- p>;</c->
    <c- n>insert_iterator</c-><c- p>(</c-><c- n>insert_iterator</c-> <c- o>&amp;&amp;</c-> <c- n>other</c-><c- p>);</c->
<c- p>};</c->
<c- k>template</c-> <c- o>&lt;</c-><c- k>class</c-> <c- nc>Container</c-><c- o>></c->
<c- n>insert_iterator</c-><c- o>&lt;</c-><c- n>Container</c-><c- o>></c-> <c- n>inserter</c-><c- p>(</c-><c- n>Container</c-><c- o>&amp;</c-> <c- n>x</c-><c- p>,</c-> <c- k>typename</c-> <c- n>Container</c-><c- o>::</c-><c- n>iterator</c-> <c- n>i</c-><c- p>);</c->
<c- p>}</c->
</pre>
   <h3 class="heading settled" data-level="8.3" id="changes-to-algorithms"><span class="secno">8.3. </span><span class="content">Changes to &lt;algorithms></span><a class="self-link" href="#changes-to-algorithms"></a></h3>
   <ul>
    <li data-md>
     <p>Algorithms in the <code class="highlight"><c- n>std</c-></code> namespace are left unchanged</p>
    <li data-md>
     <p>Algorithms in the <code class="highlight"><c- n>ranges</c-></code> namespace are modified as follow</p>
     <ul>
      <li data-md>
       <p>Algorithms requiring an <code class="highlight"><c- n>InputIterator</c-></code> are modified to take a <code class="highlight"><c- n>ReadableIterator</c-></code> instead</p>
      <li data-md>
       <p>Algorithms requiring an <code class="highlight"><c- n>OutputIterator</c-></code> are modified to take a <code class="highlight"><c- n>WritableIterator</c-></code> instead</p>
      <li data-md>
       <p>Algorithms requiring an <code class="highlight"><c- n>InputRange</c-></code> are modified to take a <code class="highlight"><c- n>ReadableRange</c-></code> instead</p>
      <li data-md>
       <p>Algorithms requiring an <code class="highlight"><c- n>OutputRange</c-></code> are modified to take a <code class="highlight"><c- n>WritabledRange</c-></code> instead</p>
     </ul>
   </ul>
   <p>A systematic review needs to be conducted to make sure that all algorithms in the <code class="highlight"><c- n>ranges</c-></code> namespace satisfy the <code class="highlight"><c- n>InputIterator</c-></code> concept as proposed in this proposal.</p>
   <p>Should algorithms not satisfy <code class="highlight"><c- n>InputIterator</c-></code> (because they depend on copy-constructability) - they would need to be modified to
accept either an <code class="highlight"><c- n>InputIterator</c-></code> or a <code class="highlight"><c- n>ForwardIterator</c-></code></p>
   <h2 class="heading settled" data-level="9" id="impact-on-other-proposals"><span class="secno">9. </span><span class="content">Impact on other proposals</span><a class="self-link" href="#impact-on-other-proposals"></a></h2>
   <h3 class="heading settled" data-level="9.1" id="istream_view"><span class="secno">9.1. </span><span class="content">istream_view</span><a class="self-link" href="#istream_view"></a></h3>
   <p>A better alternative to istream_iterator is offered by <a data-link-type="biblio" href="#biblio-p1035r0">[P1035R0]</a>'s <code class="highlight"><c- n>istream_view</c-></code>.
While implementation-defined, <code class="highlight"><c- n>istream_view</c-></code>'s iterators would need to model <code class="highlight"><c- n>InputRange</c-></code> and therefore make use of <code class="highlight"><c- n>InputIterator</c-></code> as proposed here.</p>
   <p>Given that it does not need to own an Iterator but only a handle to the underlying device, <code class="highlight"><c- n>istream_view</c-></code> can be semi-regular.</p>
   <h3 class="heading settled" data-level="9.2" id="iterator-facade"><span class="secno">9.2. </span><span class="content">Iterator facade</span><a class="self-link" href="#iterator-facade"></a></h3>
   <p><a data-link-type="biblio" href="#biblio-p0186r0">[P0186R0]</a> describes a system for an iterator facade.</p>
   <p>We propose that</p>
   <ul>
    <li data-md>
     <p>An iterator constructed from a move-only cursor, without an <code class="highlight"><c- n>equal</c-><c- p>(</c-><c- k>const</c-> <c- n>cursor</c-> <c- o>&amp;</c-><c- p>)</c-></code> method models an <code class="highlight"><c- n>InputIterator</c-></code> (or <code class="highlight"><c- n>OutputIterator</c-></code> depending on whether a <code class="highlight"><c- n>write</c-></code> method is defined)</p>
    <li data-md>
     <p>An iterator facade constructed from a Copyable cursor with an <code class="highlight"><c- n>equal</c-><c- p>(</c-><c- k>const</c-> <c- n>cursor</c-> <c- o>&amp;</c-><c- p>)</c-></code> method models an <code class="highlight"><c- n>ForwardIterator</c-></code></p>
    <li data-md>
     <p>Unless it defines a <code class="highlight"><c- n>single_pass</c-> <c- o>=</c-> true</code> trait in which case it should models <code class="highlight"><c- n>Cpp17InputIterator</c-></code>.</p>
    <li data-md>
     <p>An iterator facade cannot be constructed from a cursor that either defines <code class="highlight"><c- n>equal</c-></code> or models Copyable but not both.</p>
   </ul>
  </main>
<script>
(function() {
  "use strict";
  var collapseSidebarText = '<span aria-hidden="true">←</span> '
                          + '<span>Collapse Sidebar</span>';
  var expandSidebarText   = '<span aria-hidden="true">→</span> '
                          + '<span>Pop Out Sidebar</span>';
  var tocJumpText         = '<span aria-hidden="true">↑</span> '
                          + '<span>Jump to Table of Contents</span>';

  var sidebarMedia = window.matchMedia('screen and (min-width: 78em)');
  var autoToggle   = function(e){ toggleSidebar(e.matches) };
  if(sidebarMedia.addListener) {
    sidebarMedia.addListener(autoToggle);
  }

  function toggleSidebar(on) {
    if (on == undefined) {
      on = !document.body.classList.contains('toc-sidebar');
    }

    /* Don’t scroll to compensate for the ToC if we’re above it already. */
    var headY = 0;
    var head = document.querySelector('.head');
    if (head) {
      // terrible approx of "top of ToC"
      headY += head.offsetTop + head.offsetHeight;
    }
    var skipScroll = window.scrollY < headY;

    var toggle = document.getElementById('toc-toggle');
    var tocNav = document.getElementById('toc');
    if (on) {
      var tocHeight = tocNav.offsetHeight;
      document.body.classList.add('toc-sidebar');
      document.body.classList.remove('toc-inline');
      toggle.innerHTML = collapseSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, 0 - tocHeight);
      }
      tocNav.focus();
      sidebarMedia.addListener(autoToggle); // auto-collapse when out of room
    }
    else {
      document.body.classList.add('toc-inline');
      document.body.classList.remove('toc-sidebar');
      toggle.innerHTML = expandSidebarText;
      if (!skipScroll) {
        window.scrollBy(0, tocNav.offsetHeight);
      }
      if (toggle.matches(':hover')) {
        /* Unfocus button when not using keyboard navigation,
           because I don’t know where else to send the focus. */
        toggle.blur();
      }
    }
  }

  function createSidebarToggle() {
    /* Create the sidebar toggle in JS; it shouldn’t exist when JS is off. */
    var toggle = document.createElement('a');
      /* This should probably be a button, but appearance isn’t standards-track.*/
    toggle.id = 'toc-toggle';
    toggle.class = 'toc-toggle';
    toggle.href = '#toc';
    toggle.innerHTML = collapseSidebarText;

    sidebarMedia.addListener(autoToggle);
    var toggler = function(e) {
      e.preventDefault();
      sidebarMedia.removeListener(autoToggle); // persist explicit off states
      toggleSidebar();
      return false;
    }
    toggle.addEventListener('click', toggler, false);


    /* Get <nav id=toc-nav>, or make it if we don’t have one. */
    var tocNav = document.getElementById('toc-nav');
    if (!tocNav) {
      tocNav = document.createElement('p');
      tocNav.id = 'toc-nav';
      /* Prepend for better keyboard navigation */
      document.body.insertBefore(tocNav, document.body.firstChild);
    }
    /* While we’re at it, make sure we have a Jump to Toc link. */
    var tocJump = document.getElementById('toc-jump');
    if (!tocJump) {
      tocJump = document.createElement('a');
      tocJump.id = 'toc-jump';
      tocJump.href = '#toc';
      tocJump.innerHTML = tocJumpText;
      tocNav.appendChild(tocJump);
    }

    tocNav.appendChild(toggle);
  }

  var toc = document.getElementById('toc');
  if (toc) {
    createSidebarToggle();
    toggleSidebar(sidebarMedia.matches);

    /* If the sidebar has been manually opened and is currently overlaying the text
       (window too small for the MQ to add the margin to body),
       then auto-close the sidebar once you click on something in there. */
    toc.addEventListener('click', function(e) {
      if(e.target.tagName.toLowerCase() == "a" && document.body.classList.contains('toc-sidebar') && !sidebarMedia.matches) {
        toggleSidebar(false);
      }
    }, false);
  }
  else {
    console.warn("Can’t find Table of Contents. Please use <nav id='toc'> around the ToC.");
  }

  /* Wrap tables in case they overflow */
  var tables = document.querySelectorAll(':not(.overlarge) > table.data, :not(.overlarge) > table.index');
  var numTables = tables.length;
  for (var i = 0; i < numTables; i++) {
    var table = tables[i];
    var wrapper = document.createElement('div');
    wrapper.className = 'overlarge';
    table.parentNode.insertBefore(wrapper, table);
    wrapper.appendChild(table);
  }

})();
</script>
  <h2 class="no-num no-ref heading settled" id="references"><span class="content">References</span><a class="self-link" href="#references"></a></h2>
  <h3 class="no-num no-ref heading settled" id="informative"><span class="content">Informative References</span><a class="self-link" href="#informative"></a></h3>
  <dl>
   <dt id="biblio-p0186r0">[P0186R0]
   <dd>Beman Dawes, Eric Niebler, Casey Carter. <a href="https://wg21.link/p0186r0">Iterator Facade Library Proposal for Ranges</a>. 11 February 2016. URL: <a href="https://wg21.link/p0186r0">https://wg21.link/p0186r0</a>
   <dt id="biblio-p0541r1">[P0541R1]
   <dd>Eric Niebler. <a href="https://wg21.link/p0541r1">Ranges TS: Post-Increment on Input and Output Iterators</a>. 10 July 2017. URL: <a href="https://wg21.link/p0541r1">https://wg21.link/p0541r1</a>
   <dt id="biblio-p0896r2">[P0896R2]
   <dd>Eric Niebler, Casey Carter, Christopher Di Bella. <a href="https://wg21.link/p0896r2">The One Ranges Proposal</a>. 25 June 2018. URL: <a href="https://wg21.link/p0896r2">https://wg21.link/p0896r2</a>
   <dt id="biblio-p0902r0">[P0902R0]
   <dd>Andrew Hunter. <a href="https://wg21.link/p0902r0">Move-only iterators</a>. 5 February 2018. URL: <a href="https://wg21.link/p0902r0">https://wg21.link/p0902r0</a>
   <dt id="biblio-p1035r0">[P1035R0]
   <dd>Christopher Di Bella. <a href="https://wg21.link/p1035r0">Input range adaptors</a>. 7 May 2018. URL: <a href="https://wg21.link/p1035r0">https://wg21.link/p1035r0</a>
  </dl>